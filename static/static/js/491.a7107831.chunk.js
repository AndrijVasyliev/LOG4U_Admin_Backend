"use strict";(self.webpackChunkadmin_frontend=self.webpackChunkadmin_frontend||[]).push([[491],{344:function(e,n,a){a.d(n,{E8:function(){return g},Wn:function(){return b},k4:function(){return x},BB:function(){return v},P9:function(){return h},kg:function(){return m},rz:function(){return l},He:function(){return u},kD:function(){return f},_H:function(){return p},RS:function(){return d},g7:function(){return s},uW:function(){return Z},np:function(){return P}});var t=a(9439),r=a(1413),c=a(3619),o=new URL(window.location.href).origin,i=function(e){var n,a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,r.Z)((0,r.Z)({},t),{},{headers:new Headers});return o.headers.set("Authorization","Basic "+btoa((null===(n=c.b.user)||void 0===n?void 0:n.username)+":"+(null===(a=c.b.user)||void 0===a?void 0:a.password))),fetch(e,o).then((function(e){if(200!==e.status&&201!==e.status){var n=new Error;if(n.cause=e,e.status)switch(n.name=e.status+" "+e.statusText,e.status){case 403:n.message="Insufficient permissions";break;case 404:n.message="Not found";break;default:n.message="Some server error has occurred"}else n.message="Network error has occurred";throw n}return e.json().catch((function(e){var n=new Error;throw n.cause=e,n.name="Fetch error",n.message="Server responded with incorrect data",n}))})).catch((function(e){var n=new Error;throw n.cause=e,n.name="Fetch error",n.message="Network error has occurred",n}))},s=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/truck",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.truckNumber&&u.searchParams.append("truckNumber","".concat(d.truckNumber)),null!==d&&void 0!==d&&d.lastLocation&&null!==d&&void 0!==d&&d.distance&&(u.searchParams.append("lastLocation","".concat(d.lastLocation)),u.searchParams.append("distance","".concat(d.distance))),i(u)},d=function(e){var n=new URL("/truck/".concat(e),o);return i(n,{method:"DELETE"})},u=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/location",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.search&&u.searchParams.append("search","".concat(d.search)),null!==d&&void 0!==d&&d.name&&u.searchParams.append("name","".concat(d.name)),i(u)},l=function(e){var n=new URL("/location/".concat(e),o);return i(n,{method:"DELETE"})},m=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/load",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.loadNumber&&u.searchParams.append("loadNumber","".concat(d.loadNumber)),null!==d&&void 0!==d&&d.truckNumber&&u.searchParams.append("truckNumber","".concat(d.truckNumber)),i(u)},h=function(e){var n=new URL("/load/".concat(e),o);return i(n,{method:"DELETE"})},p=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/owner",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.fullName&&u.searchParams.append("fullName","".concat(d.fullName)),null!==d&&void 0!==d&&d.truckNumber&&u.searchParams.append("truckNumber","".concat(d.truckNumber)),i(u)},f=function(e){var n=new URL("/owner/".concat(e),o);return i(n,{method:"DELETE"})},v=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/driver",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.fullName&&u.searchParams.append("fullName","".concat(d.fullName)),null!==d&&void 0!==d&&d.truckNumber&&u.searchParams.append("truckNumber","".concat(d.truckNumber)),i(u)},x=function(e){var n=new URL("/driver/".concat(e),o);return i(n,{method:"DELETE"})},b=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/coordinator",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.fullName&&u.searchParams.append("fullName","".concat(d.fullName)),null!==d&&void 0!==d&&d.truckNumber&&u.searchParams.append("truckNumber","".concat(d.truckNumber)),i(u)},g=function(e){var n=new URL("/coordinator/".concat(e),o);return i(n,{method:"DELETE"})},P=function(e){var n=(0,t.Z)(e.queryKey,6),a=(n[0],n[1]),r=n[2],c=n[3],s=n[4],d=n[5],u=new URL("/user",o);return u.searchParams.append("limit","".concat(r)),u.searchParams.append("offset","".concat(r*a)),c&&s&&(u.searchParams.append("orderby","".concat(c)),u.searchParams.append("direction","".concat(s))),null!==d&&void 0!==d&&d.fullName&&u.searchParams.append("fullName","".concat(d.fullName)),i(u)},Z=function(e){var n=new URL("/user/".concat(e),o);return i(n,{method:"DELETE"})}},9491:function(e,n,a){a.r(n),a.d(n,{default:function(){return Q}});var t=a(1413),r=a(3433),c=a(9439),o=a(2791),i=a(7689),s=a(6403),d=a(3418),u=a(2917),l=a(6934),m=a(2065),h=a(5377),p=a(7391),f=a(68),v=a(3994),x=a(7865),b=a(4554),g=a(9836),P=a(3382),Z=a(9281),w=a(6890),y=a(6812),k=a(5855),j=a(720),N=a(4663),C=a(890),E=a(5527),L=a(1889),S=a(6151),D=a(3400),R=a(1588),F=a(1903),T=a(1528),O=a(5573),U=a(3199),q=a(1605),I=a(344),z=a(4047),H=a(184),K=[{id:"truckNumber",orderField:"truckNumber",getData:function(e){return{data:"".concat(e.truckNumber)}},numeric:!0,disablePadding:!1,label:"Truck\xa0Number"},{id:"mainContactInfo",getData:function(e){var n=e.coordinator,a=e.owner,t="",r="",c="",o="";return n?(t="./coordinators/view/".concat(n.id),r="(C) ",c="".concat(n.fullName),o="".concat(null===n||void 0===n?void 0:n.phone)):a&&(t="./owners/view/".concat(a.id),r="".concat("Owner"===a.type?"(O) ":"").concat("OwnerDriver"===a.type?"(O/d) ":""),c="".concat(a.fullName),o="".concat(null===a||void 0===a?void 0:a.phone)),{data:(0,H.jsxs)("span",{children:[(0,H.jsx)("b",{children:r}),(0,H.jsx)("a",{href:t,target:"_blank",onClick:B,children:c}),(0,H.jsx)("br",{}),(0,H.jsx)("a",{href:o?"tel:".concat(o):void 0,target:"_blank",onClick:B,children:o||"\xa0"})]}),title:r+""+c+"\n"+o}},numeric:!1,disablePadding:!0,label:"Main\xa0Contact\xa0info"},{id:"truckInfo",getData:function(e){var n=e.type?"".concat(e.type):"",a=e.equipment?"".concat(e.equipment.join(", ")):"";return{data:(0,H.jsxs)("span",{children:[n,(0,H.jsx)("br",{}),a]}),title:n+"\n"+a}},numeric:!1,disablePadding:!0,label:"Truck\xa0info"},{id:"dimsPayload",getData:function(e){var n=e.doorDims?"".concat(e.doorDims):"",a=e.payload?"".concat(e.payload):"";return{data:(0,H.jsxs)("span",{children:[n,(0,H.jsx)("br",{}),a]}),title:n+"\n"+a}},numeric:!1,disablePadding:!0,label:"DIMS/Payload"},{id:"status",orderField:"status",getData:function(e){return{data:"".concat(e.status)}},numeric:!1,disablePadding:!0,label:"Status"},{id:"roadsDistance",getData:function(e){return{data:"".concat(e.milesByRoads?e.milesByRoads.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Road\xa0distance"},{id:"location",getData:function(e){if(null!==e&&void 0!==e&&e.lastCity){var n="./locations/view/".concat(e.lastCity.id),a="".concat(e.lastCity.name,", ").concat(e.lastCity.stateCode,", ").concat(e.lastCity.zipCode,","),t="".concat(e.locationUpdatedAt?new Date(e.locationUpdatedAt).toLocaleString():"");return{data:(0,H.jsxs)("span",{children:[(0,H.jsx)("a",{href:n,target:"_blank",onClick:B,children:a}),(0,H.jsx)("br",{}),t]}),title:a+"\n"+t}}return{data:""}},numeric:!1,disablePadding:!0,label:"Last\xa0known\xa0location"},{id:"calcDistance",getData:function(e){return{data:"".concat(e.milesHaversine?e.milesHaversine.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Origin\xa0away"}],W=(0,l.ZP)(w.Z)((function(e){return{backgroundColor:e.theme.palette.background.default}})),A=(0,l.ZP)(v.Z)((function(e){e.theme;return{maxWidth:"100px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}));function B(e){e.stopPropagation()}function _(e){e.onSelectAllClick;var n=e.order,a=e.orderBy,t=(e.numSelected,e.rowCount,e.onRequestSort);return(0,H.jsx)(W,{children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(A,{align:"center",padding:"checkbox",children:"Actions"}),K.map((function(e){return(0,H.jsx)(A,{align:e.numeric?"right":"center",padding:e.disablePadding?"none":"normal",sortDirection:a===e.id&&n,children:(0,H.jsxs)(j.Z,{active:e.orderField&&a===e.orderField,hideSortIcon:!e.orderField,direction:a===e.orderField?n:"asc",onClick:e.orderField?(r=e.orderField,function(e){t(e,r)}):function(){},children:[e.label,e.orderField&&a===e.orderField?(0,H.jsx)(b.Z,{component:"span",sx:O.Z,children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},e.id);var r}))]})})}function M(e){var n=e.selected,a=e.setQueryParams,l=o.useState(null),v=(0,c.Z)(l,2),g=v[0],P=v[1],Z=o.useState(""),w=(0,c.Z)(Z,2),y=w[0],k=w[1],j=o.useState({}),E=(0,c.Z)(j,2),S=E[0],O=E[1],q=o.useState([]),K=(0,c.Z)(q,2),W=K[0],A=K[1],B=o.useState(200),_=(0,c.Z)(B,2),M=_[0],Q=_[1],J=o.useState(!1),G=(0,c.Z)(J,2),V=G[0],X=G[1],Y=((0,i.TH)(),(0,i.s0)(),(0,s.NL)()),$=(0,z.Ds)(),ee=((0,d.D)(I.RS,{onSuccess:function(){$({severity:"success",message:"Deleted"}),Y.invalidateQueries(["trucks"])},onError:function(e){$({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),o.useMemo((function(){return(0,U.Z)((function(e){O({search:e})}),400)}),[])),ne=(0,u.a)({queryKey:["locations",0,15,"name","asc",S],queryFn:I.He,keepPreviousData:!0}).data,ae=(void 0===ne?{items:[],total:0}:ne).items;o.useEffect((function(){if(""!==y){var e=[];g&&(e=[g]),ae.length&&(e=[].concat((0,r.Z)(e),(0,r.Z)(ae))),A(e)}else A(g?[g]:[])}),[g,ae]);var te=function(){null!==g&&void 0!==g&&g.location&&(a({lastLocation:g.location.join(","),distance:M}),X(!1))};return(0,H.jsxs)(N.Z,{sx:(0,t.Z)({pl:{sm:2},pr:{xs:1,sm:1}},n.length>0&&{bgcolor:function(e){return(0,m.Fq)(e.palette.primary.main,e.palette.action.activatedOpacity)}}),children:[n.length>0?(0,H.jsxs)(C.Z,{sx:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1",component:"div",children:[n.length," selected"]}):(0,H.jsx)(C.Z,{sx:{flex:"1 1 100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},variant:"h6",id:"tableTitle",component:"div",children:"Trucks Nearby"}),(0,H.jsx)(b.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"350px"}},children:(0,H.jsx)(h.Z,{getOptionLabel:function(e){return"string"===typeof e?e:"".concat(e.name,", ").concat(e.zipCode,", ").concat(e.stateName)},filterOptions:function(e){return e},options:W,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!0,value:g,noOptionsText:"No locations",onChange:function(e,n){A(n?[n].concat((0,r.Z)(W)):W),P(n),te(),null!==n&&void 0!==n&&n.location?(a({lastLocation:n.location.join(","),distance:M}),X(!1)):n||(k(""),a({}),X(!1))},onInputChange:function(e,n){k(n),ee(n)},renderInput:function(e){return(0,H.jsx)(p.Z,(0,t.Z)((0,t.Z)({},e),{},{label:"Enter city, state or zip",size:"small",fullWidth:!0}))},renderOption:function(e,n){return(0,H.jsx)("li",(0,t.Z)((0,t.Z)({},e),{},{children:(0,H.jsxs)(L.ZP,{container:!0,alignItems:"center",children:[(0,H.jsx)(L.ZP,{item:!0,sx:{display:"flex",width:44},children:(0,H.jsx)(R.Z,{sx:{color:"text.secondary"}})}),(0,H.jsxs)(L.ZP,{item:!0,sx:{width:"calc(100% - 44px)",wordWrap:"break-word"},children:[(0,H.jsx)(b.Z,{component:"span",sx:{fontWeight:"regular"},children:"".concat(n.name,", ").concat(n.stateCode)}),(0,H.jsx)(C.Z,{variant:"body2",color:"text.secondary",children:"".concat(n.zipCode,", ").concat(n.stateName)})]})]})}))}})}),(0,H.jsx)(b.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"140px"}},children:(0,H.jsx)(p.Z,{select:!0,label:"Select Distance",value:M,onChange:function(e){Number.isInteger(Number(e.target.value))&&(Q(Number(e.target.value)),X(!0))},size:"small",fullWidth:!0,children:Array.from({length:20},(function(e,n){return 50+50*n})).map((function(e){return(0,H.jsx)(x.Z,{value:e,children:e},e)}))})}),(0,H.jsx)(f.Z,{title:"Filter list",children:!V&&g||V&&!g?(0,H.jsx)(D.Z,{onClick:function(){P(null),k(""),Q(200),a({}),X(!1)},children:(0,H.jsx)(T.Z,{})}):(0,H.jsx)("span",{children:(0,H.jsx)(D.Z,{disabled:!g||!M,onClick:te,children:(0,H.jsx)(F.Z,{})})})})]})}function Q(){var e=o.useState(void 0),n=(0,c.Z)(e,2),a=n[0],t=n[1],r=o.useState(void 0),s=(0,c.Z)(r,2),d=s[0],l=s[1],m=o.useState([]),h=(0,c.Z)(m,2),p=h[0],f=h[1],v=o.useState(0),x=(0,c.Z)(v,2),w=x[0],j=x[1],N=o.useState(15),C=(0,c.Z)(N,2),L=C[0],D=C[1],R=o.useState({}),F=(0,c.Z)(R,2),T=F[0],O=F[1],U=o.useRef(null),W=(0,i.TH)(),B=(0,i.s0)(),Q=(0,z.Ds)(),J=(0,u.a)({queryKey:["trucks",w,L,d,a,T],queryFn:I.g7,keepPreviousData:!0,onError:function(e){Q({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),G=J.isLoading,V=J.isFetching,X=J.data,Y=void 0===X?{items:[],total:0}:X,$=Y.items,ee=Y.total,ne=$||[];o.useEffect((function(){U.current&&U.current.scrollTo({top:0,left:0,behavior:"smooth"})}),[ne]),o.useEffect((function(){var e=[];p.forEach((function(n){ne.find((function(e){return e.id===n}))&&e.push(n)})),f(e)}),[ne]);return(0,H.jsxs)(b.Z,{sx:{width:"100%",height:"100%"},children:[(0,H.jsxs)(E.Z,{sx:{width:"100%",height:"100%",backgroundColor:"unset"},children:[(0,H.jsx)(M,{selected:p,setQueryParams:function(e){O(e),j(0)}}),(0,H.jsx)(Z.Z,{ref:U,sx:{height:"calc(100% - 115px)"},children:(0,H.jsxs)(g.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",stickyHeader:!0,children:[(0,H.jsx)(_,{numSelected:p.length,order:a,orderBy:d,onSelectAllClick:function(e){if(e.target.checked){var n=ne.map((function(e){return e.id}));f(n)}else f([])},onRequestSort:function(e,n){var r=d===n&&"asc"===a;d===n&&"desc"===a?(t(void 0),l(void 0)):(t(r?"desc":"asc"),l(n))},rowCount:ne.length}),(0,H.jsx)(P.Z,{children:ne.map((function(e,n){var a,t=(a="".concat(e.id),-1!==p.indexOf(a)),r="enhanced-table-checkbox-".concat(n);return(0,H.jsxs)(k.Z,{hover:!0,onClick:function(n){return function(e,n){B("./view/".concat(n),{relative:"path",state:{from:W},replace:!1})}(0,"".concat(e.id))},role:"checkbox","aria-checked":t,tabIndex:-1,selected:t,sx:{cursor:"pointer"},children:[(0,H.jsx)(A,{padding:"checkbox",children:(0,H.jsx)(S.Z,{id:"".concat(r),sx:{m:1},fullWidth:!0,variant:"contained",size:"small",color:"primary",onClick:function(){},children:"Reserve"})}),K.map((function(n){var a=n.getData(e);return(0,H.jsx)(A,{title:a.title,align:n.numeric?"right":"center",children:a.data},n.id)}))]},e.id)}))})]})}),(0,H.jsx)(y.Z,{rowsPerPageOptions:[5,10,15,20,25,35,50],component:"div",count:ee,rowsPerPage:L,page:w,onPageChange:function(e,n){j(n)},onRowsPerPageChange:function(e){D(parseInt(e.target.value,10)),j(0)}})]}),(0,H.jsx)(q.Z,{visible:G||V})]})}}}]);
//# sourceMappingURL=491.a7107831.chunk.js.map