"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[666],{1666:function(e,t,n){n.r(t),n.d(t,{default:function(){return ne}});var i=n(5987),a=n(1413),r=n(3433),o=n(9439),c=n(2791),l=n(7689),s=n(6403),d=n(3418),u=n(2917),f=n(6934),h=n(2065),x=n(5699),p=n(8550),m=n(68),g=n(3994),v=n(3786),Z=n(4554),j=n(9836),b=n(3382),y=n(9281),k=n(6890),w=n(3033),C=n(5855),S=n(720),D=n(4663),P=n(890),N=n(5527),A=n(1889),F=n(3400),T=n(1588),E=n(1903),I=n(1528),z=n(194),L=n(5573),O=n(3199),R=n(4294),H=n(1518),q=n(344),U=n(184),W=15,B=function(e){var t=(e-new Date)/6e4;return t=t>0?Math.ceil(t):0};function _(e){var t=e.truck,n=e.index,i=c.useState(0),a=(0,o.Z)(i,2),r=a[0],l=a[1],u=t.reservedAt,f=t.reservedBy,h=u&&(0,H.Z)(new Date(u),W),x=new Date<h;c.useEffect((function(){if(x){l(B(h));var e=setInterval((function(){l(B(h))}),2e3);return function(){clearInterval(e),l(0)}}}),[x,h]);var p=(0,s.NL)(),m=(0,d.D)(q.hu,{onSuccess:function(){p.invalidateQueries({queryKey:["trucks"],refetchType:"active"})},onError:function(e){}}),g=m.mutate,v=(m.isLoading,"enhanced-table-checkbox-".concat(n)),Z="".concat(x&&f?"Reserved by:\n"+f.fullName+"\nTime left: "+r+"min":"");return(0,U.jsx)(R.Z,{id:"".concat(v),title:Z,sx:{m:1,height:"35px",lineHeight:"normal",fontSize:"x-small"},fullWidth:!0,variant:"contained",size:"small",color:"primary",onClickCapture:function(e){e.preventDefault(),e.stopPropagation(),g({id:t.id,reservedAt:x?null:new Date})},children:x?(0,U.jsxs)("span",{children:["Unreserve",(0,U.jsx)("br",{}),"(",r,"min)"]}):"Reserve"})}var M=n(1605),K=n(4682),Q=n(2835),J=n(5916),V=n(7004),G=["status"],X=[{id:"truckNumber",orderField:"truckNumber",getData:function(e){return{data:"".concat(e.truckNumber)}},numeric:!0,disablePadding:!1,label:"Truck\xa0Number"},{id:"mainContactInfo",getData:function(e){var t=e.coordinator||e.owner,n="",i="",a="",r="";return t&&(n="./".concat((0,J.DW)(t),"/view/").concat(t.id),i="".concat((0,J.oL)(t)," "),a="".concat(t.fullName),r="".concat(null===t||void 0===t?void 0:t.phone)),{data:(0,U.jsxs)("span",{style:{display:"flex"},children:[(0,U.jsxs)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",textAlign:"left"},children:[(0,U.jsx)("b",{children:i}),(0,U.jsx)("a",{href:n,target:"_blank",onClick:V.U,children:a}),(0,U.jsx)("br",{}),(0,U.jsx)("a",{href:r?"tel:".concat(r):void 0,target:"_blank",onClick:V.U,children:r||"\xa0"})]}),(0,U.jsx)(F.Z,{size:"small",onClick:function(e){(0,V.U)(e),navigator.clipboard.writeText(a+" "+r)},children:(0,U.jsx)(z.Z,{sx:{height:"16px",width:"16px"}})})]}),title:i+""+a+"\n"+r}},numeric:!1,disablePadding:!0,label:"Main\xa0Contact\xa0info"},{id:"truckInfo",getData:function(e){var t=e.type?"".concat(e.type):"",n=e.equipment?"".concat(e.equipment.join(", ")):"";return{data:(0,U.jsxs)("span",{children:[t,(0,U.jsx)("br",{}),n]}),title:t+"\n"+n}},numeric:!1,disablePadding:!0,label:"Truck\xa0info"},{id:"dimsAndPayload",getData:function(e){var t=e.insideDims?"".concat(e.insideDims):"",n=e.doorDims?"".concat(e.doorDims):"",i=e.payload?"".concat(e.payload):"";return{data:(0,U.jsxs)("span",{children:[(t?t+" ":"")+n,(0,U.jsx)("br",{}),i]}),title:(t?t+" Inside ":"")+(n?n+" Door ":"")+"\n"+i+" Payload"}},numeric:!1,disablePadding:!0,label:"DIMS/Payload"},{id:"status",orderField:"status",getData:function(e){return{data:"".concat(e.status)}},numeric:!1,disablePadding:!0,label:"Status"},{id:"roadsDistance",getData:function(e){return{data:"".concat(e.milesByRoads?e.milesByRoads.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Road\xa0distance"},{id:"location",getData:function(e){if(null!==e&&void 0!==e&&e.lastCity){var t="./locations/view/".concat(e.lastCity.id),n="".concat(e.lastCity.name,", ").concat(e.lastCity.stateCode,", ").concat(e.lastCity.zipCode),i="".concat(e.locationUpdatedAt?new Date(e.locationUpdatedAt).toLocaleString():"");return{data:(0,U.jsxs)("span",{style:{display:"flex"},children:[(0,U.jsxs)("span",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:[(0,U.jsx)("a",{href:t,target:"_blank",onClick:V.U,children:n}),(0,U.jsx)("br",{}),i]}),(0,U.jsx)(F.Z,{size:"small",onClick:function(e){(0,V.U)(e),navigator.clipboard.writeText(n)},children:(0,U.jsx)(z.Z,{sx:{height:"16px",width:"16px"}})})]}),title:n+"\n"+i}}return{data:""}},numeric:!1,disablePadding:!0,label:"Last\xa0known\xa0location"},{id:"calcDistance",getData:function(e){return{data:"".concat(e.milesHaversine?e.milesHaversine.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Origin\xa0away"}],Y=(0,f.ZP)(k.Z)((function(e){return{backgroundColor:e.theme.palette.background.default}})),$=(0,f.ZP)(g.Z)((function(e){e.theme;return{maxWidth:"100px",paddingTop:"6px",paddingBottom:"6px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}));function ee(e){e.onSelectAllClick;var t=e.order,n=e.orderBy,i=(e.numSelected,e.rowCount,e.onRequestSort);return(0,U.jsx)(Y,{children:(0,U.jsxs)(C.Z,{children:[(0,U.jsx)($,{align:"center",padding:"checkbox",children:"Actions"}),X.map((function(e){return(0,U.jsx)($,{align:e.numeric?"right":"center",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t,children:(0,U.jsxs)(S.Z,{active:e.orderField&&n===e.orderField,hideSortIcon:!e.orderField,direction:n===e.orderField?t:"asc",onClick:e.orderField?(a=e.orderField,function(e){i(e,a)}):function(){},children:[e.label,e.orderField&&n===e.orderField?(0,U.jsx)(Z.Z,{component:"span",sx:L.Z,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id);var a}))]})})}function te(e){var t=e.selected,n=e.setQueryParams,f=c.useState(null),g=(0,o.Z)(f,2),j=g[0],b=g[1],y=c.useState(""),k=(0,o.Z)(y,2),w=k[0],C=k[1],S=c.useState({}),N=(0,o.Z)(S,2),z=N[0],L=N[1],R=c.useState([]),H=(0,o.Z)(R,2),W=H[0],B=H[1],_=c.useState("All"),V=(0,o.Z)(_,2),X=V[0],Y=V[1],$=c.useState(200),ee=(0,o.Z)($,2),te=ee[0],ne=ee[1],ie=c.useState(!1),ae=(0,o.Z)(ie,2),re=ae[0],oe=ae[1],ce=((0,l.TH)(),(0,l.s0)(),(0,s.NL)()),le=(0,K.Ds)(),se=(0,d.D)(q.RS,{onSuccess:function(){le({severity:"success",message:"Deleted"}),ce.invalidateQueries(["trucks"])},onError:function(e){le({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),de=(se.mutate,se.isLoading),ue=c.useMemo((function(){return(0,O.Z)((function(e){L({search:e})}),400)}),[]),fe=(0,u.a)({queryKey:["locations",0,15,"name","asc",z],queryFn:(0,J.vc)(q.He,!0),keepPreviousData:!0,retry:!1}).data,he=(void 0===fe?{items:[],total:0}:fe).items;c.useEffect((function(){if(j){var e=he.filter((function(e){return e.id!==j.id}));B([j].concat((0,r.Z)(e)))}else B(""===w?[]:(0,r.Z)(he))}),[j,he]);return console.log(re||!j&&"All"===X),console.log(!(re&&!j)||!(re&&"All"===X)),(0,U.jsxs)(D.Z,{sx:(0,a.Z)({pl:{sm:2},pr:{xs:1,sm:1}},t.length>0&&{bgcolor:function(e){return(0,h.Fq)(e.palette.primary.main,e.palette.action.activatedOpacity)}}),children:[t.length>0?(0,U.jsxs)(P.Z,{sx:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1",component:"div",children:[t.length," selected"]}):(0,U.jsx)(P.Z,{sx:{flex:"1 1 100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},variant:"h6",id:"tableTitle",component:"div",children:"Trucks Nearby"}),(0,U.jsx)(Z.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"350px"}},children:(0,U.jsx)(x.Z,{getOptionLabel:function(e){return"string"===typeof e?e:"".concat(e.name,", ").concat(e.zipCode,", ").concat(e.stateName)},filterOptions:function(e){return e},options:W,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!1,value:j,noOptionsText:"No locations",onChange:function(e,t){b(t),null!==t&&void 0!==t&&t.location?(n({lastLocation:t.location.join(","),distance:te}),oe(!1)):t||(C(""),n({}),oe(!1))},onInputChange:function(e,t){C(t),ue(t)},renderInput:function(e){return(0,U.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{label:"Enter city, state or zip",size:"small",fullWidth:!0}))},renderOption:function(e,t){return(0,U.jsx)("li",(0,a.Z)((0,a.Z)({},e),{},{children:(0,U.jsxs)(A.ZP,{container:!0,alignItems:"center",children:[(0,U.jsx)(A.ZP,{item:!0,sx:{display:"flex",width:44},children:(0,U.jsx)(T.Z,{sx:{color:"text.secondary"}})}),(0,U.jsxs)(A.ZP,{item:!0,sx:{width:"calc(100% - 44px)",wordWrap:"break-word"},children:[(0,U.jsx)(Z.Z,{component:"span",sx:{fontWeight:"regular"},children:"".concat(t.name,", ").concat(t.stateCode)}),(0,U.jsx)(P.Z,{variant:"body2",color:"text.secondary",children:"".concat(t.zipCode,", ").concat(t.stateName)})]})]})}))}})}),(0,U.jsx)(Z.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"140px"}},children:(0,U.jsx)(p.Z,{select:!0,label:"Select Status",value:X,onChange:function(e){Y(e.target.value),Q.KN.some((function(t){return t===e.target.value}))?n((function(t){return(0,a.Z)((0,a.Z)({},t),{},{status:e.target.value})})):n((function(e){e.status;var t=(0,i.Z)(e,G);return(0,a.Z)({},t)}))},size:"small",fullWidth:!0,children:["All"].concat((0,r.Z)(Q.KN)).map((function(e){return(0,U.jsx)(v.Z,{value:e,children:e},e)}))})}),(0,U.jsx)(Z.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"140px"}},children:(0,U.jsx)(p.Z,{select:!0,label:"Select Distance",value:te,onChange:function(e){Number.isInteger(Number(e.target.value))&&(ne(Number(e.target.value)),null!==j&&void 0!==j&&j.location&&(n({lastLocation:j.location.join(","),distance:Number(e.target.value)}),oe(!1)))},size:"small",fullWidth:!0,children:Array.from({length:20},(function(e,t){return 50+50*t})).map((function(e){return(0,U.jsx)(v.Z,{value:e,children:e},e)}))})}),(0,U.jsx)(m.Z,{title:"Filter list",children:!re&&(j||"All"!==X)||re&&!j&&re&&"All"===X?(0,U.jsx)("span",{children:(0,U.jsx)(F.Z,{onClick:function(){b(null),C(""),Y("All"),ne(200),n({}),oe(!1)},children:(0,U.jsx)(I.Z,{})})}):(0,U.jsx)("span",{children:(0,U.jsx)(F.Z,{disabled:!j||!te,onClick:function(){null!==j&&void 0!==j&&j.location?n({lastLocation:j.location.join(","),distance:te}):n({}),oe(!1)},children:(0,U.jsx)(E.Z,{})})})}),(0,U.jsx)(M.Z,{visible:de})]})}function ne(){var e=c.useState(void 0),t=(0,o.Z)(e,2),n=t[0],i=t[1],a=c.useState(void 0),r=(0,o.Z)(a,2),s=r[0],d=r[1],f=c.useState([]),h=(0,o.Z)(f,2),x=h[0],p=h[1],m=c.useState(0),g=(0,o.Z)(m,2),v=g[0],k=g[1],S=c.useState(15),D=(0,o.Z)(S,2),P=D[0],A=D[1],F=c.useState({}),T=(0,o.Z)(F,2),E=T[0],I=T[1],z=c.useRef(null),L=(0,l.TH)(),O=(0,l.s0)(),R=(0,K.Ds)(),H=(0,u.a)({queryKey:["trucks",v,P,s,n,E],queryFn:q.g7,keepPreviousData:!0,retry:!1,onError:function(e){R({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),W=H.isLoading,B=H.isFetching,Q=H.data,J=void 0===Q?{items:[],total:0}:Q,V=J.items,G=J.total,Y=V||[];c.useEffect((function(){z.current&&z.current.scrollTo({top:0,left:0,behavior:"smooth"})}),[Y]),c.useEffect((function(){var e=[];x.forEach((function(t){Y.find((function(e){return e.id===t}))&&e.push(t)})),p(e)}),[Y]);return(0,U.jsxs)(Z.Z,{sx:{width:"100%",height:"100%"},children:[(0,U.jsxs)(N.Z,{sx:{width:"100%",height:"100%",backgroundColor:"unset"},children:[(0,U.jsx)(te,{selected:x,setQueryParams:function(e){I(e),k(0)}}),(0,U.jsx)(y.Z,{ref:z,sx:{height:"calc(100% - 115px)"},children:(0,U.jsxs)(j.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",stickyHeader:!0,children:[(0,U.jsx)(ee,{numSelected:x.length,order:n,orderBy:s,onSelectAllClick:function(e){if(e.target.checked){var t=Y.map((function(e){return e.id}));p(t)}else p([])},onRequestSort:function(e,t){var a=s===t&&"asc"===n;s===t&&"desc"===n?(i(void 0),d(void 0)):(i(a?"desc":"asc"),d(t))},rowCount:Y.length}),(0,U.jsx)(b.Z,{children:Y.map((function(e,t){var n,i=(n="".concat(e.id),-1!==x.indexOf(n));return(0,U.jsxs)(C.Z,{hover:!0,onClick:function(t){O("./view/".concat(e.id),{relative:"path",state:{from:L},replace:!1})},role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[(0,U.jsx)($,{padding:"checkbox",children:(0,U.jsx)(_,{truck:e,index:t})}),X.map((function(t){var n=t.getData(e);return(0,U.jsx)($,{title:n.title,align:t.numeric?"right":"center",children:n.data},t.id)}))]},e.id)}))})]})}),(0,U.jsx)(w.Z,{rowsPerPageOptions:[5,10,15,20,25,35,50],component:"div",count:G,rowsPerPage:P,page:v,onPageChange:function(e,t){k(t)},onRowsPerPageChange:function(e){A(parseInt(e.target.value,10)),k(0)}})]}),(0,U.jsx)(M.Z,{visible:W||B})]})}},2835:function(e,t,n){n.d(t,{Ep:function(){return s},Gm:function(){return r},Hz:function(){return c},KN:function(){return o},V3:function(){return i},fg:function(){return l},vX:function(){return a}});var i=["EN","UA","ES","RU"],a=["Admin","Super Admin"],r=["Cargo van","Reefer van","Box truck","Box truck Reefer","Straight truck","Hotshot","Tented box"],o=["Available","Not Available"],c=["Yes","No"],l=["Hazmat","Tsa","TWIC","Tanker Endorsement"],s=["Dock height risers","Air ride","Lift gate","Keep from freezing","ICC bar","Vertical E-track","Horizontal E-track","Pallet jack","PPE","Ramps","Straps","Loads bars","Blankets","Pads","Fire extinguisher","Metal hooks","Reefer","Heater"]}}]);
//# sourceMappingURL=666.8f155a06.chunk.js.map