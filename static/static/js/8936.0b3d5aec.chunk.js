"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[8936],{8936:function(n,o,e){e.r(o),e.d(o,{default:function(){return A}});var i=e(5987),t=e(9439),l=e(1413),r=e(2791),c=e(2917),a=e(9259),u=e(1697),d=e(5931),s=e(5574),v=e(7123),f=e(9157),h=e(4294),p=e(1691),m=e(5661),x=e(4554),j=e(3400),w=e(194),Z=e(1605),g=e(344),C=e(9063),k=e(5916),E=e(7004),L=e(4633),S=e(3026),b=e(901),y=e(184),N=["onCLick","clusterer","map","position"],T=r.forwardRef((function(n,o){return(0,y.jsx)(d.Z,(0,l.Z)({direction:"up",ref:o},n))}));function A(n){var o,e=n.truckListData,i=L.be,u=L.sP;1===e.length&&e[0].lastLocation&&(i={lat:e[0].lastLocation[0],lng:e[0].lastLocation[1]},u*=2);var d=r.useState(null),N=(0,t.Z)(d,2),A=N[0],_=N[1],F=r.useState(""),O=(0,t.Z)(F,2),R=O[0],z=O[1],D=r.useState(null),G=(0,t.Z)(D,2),P=G[0],q=G[1],K=r.useState(!1),V=(0,t.Z)(K,2),B=V[0],W=V[1],X=(0,c.a)({queryKey:["truckForMap",R],queryFn:g.dC,keepPreviousData:!1,retry:!1,enabled:!1}).refetch;r.useEffect((function(){if(R){W(!0);var n=null===e||void 0===e?void 0:e.find((function(n){return n.id===R})),o=n&&(null===n||void 0===n?void 0:n.lastLocation);Promise.all([X().then((function(n){return n.data})),o&&(null===A||void 0===A?void 0:A.geocode({location:{lat:o[0],lng:o[1]}}).then((function(n){var o=(0,S.F)(n.results);return o?(0,b.u)(o.address_components):""})))]).then((function(n){var o=(0,t.Z)(n,2),e=o[0],i=o[1];q(e?(0,l.Z)((0,l.Z)({},e),{},{lastCity:i||""}):null)})).catch((function(){return q(null)})).finally((function(){return W(!1)}))}else q(null)}),[R]);var H=function(){z("")};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(x.Z,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,y.jsx)(a.Wrapper,(0,l.Z)((0,l.Z)({},(0,L.z0)()),{},{render:function(n){var o=(0,C.Ds)(),e=(0,C.U2)(),i=(0,t.Z)(e,2)[1];return r.useLayoutEffect((function(){return n===a.Status.LOADING&&i(!0),n===a.Status.FAILURE&&o({severity:"error",message:"Error loading maps!"}),n===a.Status.SUCCESS&&_(new window.google.maps.Geocoder),function(){n===a.Status.LOADING&&i(!1)}}),[n]),null}})),A?(0,y.jsx)(M,{center:i,zoom:u,mapId:L.Kq,children:(0,y.jsx)(U,{children:e.map((function(n){return(0,y.jsx)(I,{onCLick:function(){return o=n.id,void z(o);var o},title:"".concat(n.truckNumber,"\n").concat(n.status),position:{lat:n.lastLocation[0],lng:n.lastLocation[1]}},n.id)}))})}):null]}),(0,y.jsxs)(s.Z,{open:!!P,TransitionComponent:T,keepMounted:!0,onClose:H,"aria-describedby":"alert-dialog-slide-description",children:[(0,y.jsx)(m.Z,{children:(0,y.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,y.jsx)("a",{href:"./trucks/view/".concat(null===P||void 0===P?void 0:P.id),target:"_blank",children:null===P||void 0===P?void 0:P.truckNumber})]})}),(0,y.jsxs)(f.Z,{children:[(0,y.jsx)(p.Z,{id:"truck-status",children:"CURRENT STATUS: ".concat(null===P||void 0===P?void 0:P.status)}),(0,y.jsx)(p.Z,{id:"main-contact",children:(0,y.jsxs)("span",{children:["MAIN CONTACT: ",(0,y.jsx)("b",{children:"".concat(null!==P&&void 0!==P&&P.coordinator||null!==P&&void 0!==P&&P.owner?(0,k.oL)((null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner)):"")})," ".concat(null!==P&&void 0!==P&&P.coordinator||null!==P&&void 0!==P&&P.owner?((null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner)).fullName:""),(0,y.jsx)(j.Z,{size:"small",onClick:function(n){var o;(0,E.U)(n),navigator.clipboard.writeText(" ".concat(null!==P&&void 0!==P&&P.coordinator||null!==P&&void 0!==P&&P.owner?((null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner)).fullName:""," ").concat((null===(o=(null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner))||void 0===o?void 0:o.phone)||""))},children:(0,y.jsx)(w.Z,{sx:{height:"16px",width:"16px"}})})]})}),(0,y.jsx)(p.Z,{id:"main-contact-number",children:(0,y.jsxs)("span",{children:["MAIN CONTACT #: ",(0,y.jsx)("a",{href:null!==P&&void 0!==P&&P.coordinator||null!==P&&void 0!==P&&P.owner?"tel:".concat(((null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner)).phone):void 0,target:"_blank",onClick:E.U,children:(null===(o=(null===P||void 0===P?void 0:P.coordinator)||(null===P||void 0===P?void 0:P.owner))||void 0===o?void 0:o.phone)||""})]})}),(0,y.jsx)(p.Z,{id:"last-location",children:(0,y.jsxs)("span",{children:["LAST LOCATION #: ".concat(null===P||void 0===P?void 0:P.lastCity),(0,y.jsx)(j.Z,{size:"small",onClick:function(n){(0,E.U)(n),navigator.clipboard.writeText("".concat(null===P||void 0===P?void 0:P.lastCity))},children:(0,y.jsx)(w.Z,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,y.jsx)(v.Z,{children:(0,y.jsx)(h.Z,{onClick:H,children:"Close"})})]}),(0,y.jsx)(Z.Z,{visible:B})]})}function M(n){var o=n.center,e=n.zoom,i=n.mapId,l=n.children,c=r.useRef(null),a=r.useState(),u=(0,t.Z)(a,2),d=u[0],s=u[1];r.useEffect((function(){c.current&&!d&&s(new window.google.maps.Map(c.current,{center:o,zoom:e,mapId:i}))}),[c,d]);var v=r.Children.only(l);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:{height:"100%",width:"100%"},ref:c,id:"map"}),r.isValidElement(v)&&r.cloneElement(v,{map:d})]})}function U(n){var o=n.map,e=n.children,i=r.useState(),l=(0,t.Z)(i,2),c=l[0],a=l[1];return r.useEffect((function(){return c||a(new u.XL({})),function(){c&&c.setMap(null)}}),[c]),r.useEffect((function(){c&&o&&c.setMap(o)}),[o]),r.useEffect((function(){c&&c.render()}),[o,e]),null===c||void 0===c||c.render(),(0,y.jsx)(y.Fragment,{children:r.Children.map(e,(function(n){if(r.isValidElement(n))return r.cloneElement(n,{map:o,clusterer:c})}))})}var I=function(n){var o=n.onCLick,e=n.clusterer,l=n.map,c=n.position,a=(0,i.Z)(n,N),u=r.useState(),d=(0,t.Z)(u,2),s=d[0],v=d[1];return r.useEffect((function(){if(!s){var n=new window.google.maps.marker.AdvancedMarkerElement;v(n),n.addListener("click",o)}return function(){s&&(s.map=null,null===e||void 0===e||e.removeMarker(s,!1))}}),[s]),r.useEffect((function(){s&&(s.map=l||null)}),[s,l]),r.useEffect((function(){s&&(s.position=c)}),[s,c&&"".concat(null===c||void 0===c?void 0:c.lat,",").concat(null===c||void 0===c?void 0:c.lng)]),r.useEffect((function(){s&&(null===e||void 0===e||e.addMarker(s,!1))}),[s,e]),r.useEffect((function(){s&&Object.assign(s,a)}),[s,a]),null}},7004:function(n,o,e){function i(n){n.stopPropagation()}e.d(o,{U:function(){return i}})}}]);
//# sourceMappingURL=8936.0b3d5aec.chunk.js.map