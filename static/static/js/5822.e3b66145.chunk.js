"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[5822],{5822:(e,n,o)=>{o.r(n),o.d(n,{default:()=>b});var l=o(5043),i=o(5604),t=o(5563),r=o(237),d=o(4836),s=o(1081),a=o(9347),c=o(5316),u=o(1906),v=o(8533),h=o(6600),p=o(7353),f=o(7392),m=o(6910),x=o(8612),w=o(1079),j=o(908),g=o(6431),A=o(7166),k=o(5552),C=o(4133),E=o(9129),S=o(579);const L=l.forwardRef((function(e,n){return(0,S.jsx)(d.A,{direction:"up",ref:n,...e})}));function b(e){var n;let{truckListData:o}=e,r=k.gX,d=k.s_;1===o.length&&o[0].lastLocation&&(r={lat:o[0].lastLocation[0],lng:o[0].lastLocation[1]},d*=2);const[b,T]=l.useState(null),[I,_]=l.useState(""),[M,O]=l.useState(null),[R,U]=l.useState(!1),{refetch:z}=(0,i.I)({queryKey:["truckForMap",I],queryFn:w.k$,keepPreviousData:!0,retry:!1,enabled:!1});l.useEffect((()=>{if(I){U(!0);const e=null===o||void 0===o?void 0:o.find((e=>e.id===I)),n=e&&(null===e||void 0===e?void 0:e.lastLocation);Promise.all([z().then((e=>e.data)),n&&((null===b||void 0===b?void 0:b.geocode({location:{lat:n[0],lng:n[1]}}))||Promise.reject()).then((e=>{const n=(0,C.U)(e.results);return n?(0,E.s)(n.address_components):""}))]).then((e=>{let[n,o]=e;O(n?{...n,lastCity:o||""}:null)})).catch((()=>O(null))).finally((()=>U(!1)))}else O(null)}),[I]);const F=()=>{_("")};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(p.A,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,S.jsx)(t.Wrapper,{...(0,k.iz)(),render:e=>{const n=(0,j.dh)(),[,o]=(0,j.pn)();return l.useLayoutEffect((()=>(e===t.Status.LOADING&&o(!0),e===t.Status.FAILURE&&n({severity:"error",message:"Error loading maps!"}),e===t.Status.SUCCESS&&T(new window.google.maps.Geocoder),()=>{e===t.Status.LOADING&&o(!1)})),[e]),null}}),b?(0,S.jsx)(y,{center:r,zoom:d,mapId:k.yw,children:(0,S.jsx)($,{children:o.map((e=>(0,S.jsx)(N,{onCLick:()=>{return n=e.id,void _(n);var n},title:`${e.truckNumber}\n${e.status}`,position:{lat:e.lastLocation[0],lng:e.lastLocation[1]}},e.id)))})}):null]}),(0,S.jsxs)(s.A,{open:!!M,TransitionComponent:L,keepMounted:!0,onClose:F,"aria-describedby":"alert-dialog-slide-description",children:[(0,S.jsx)(h.A,{children:(0,S.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,S.jsx)("a",{href:`./trucks/view/${null===M||void 0===M?void 0:M.id}`,target:"_blank",children:null===M||void 0===M?void 0:M.truckNumber})]})}),(0,S.jsxs)(c.A,{children:[(0,S.jsx)(v.A,{id:"truck-status",children:`CURRENT STATUS: ${null===M||void 0===M?void 0:M.status}`}),(0,S.jsx)(v.A,{id:"main-contact",children:(0,S.jsxs)("span",{children:["MAIN CONTACT: ",(0,S.jsx)("b",{children:`${null!==M&&void 0!==M&&M.coordinator||null!==M&&void 0!==M&&M.owner?(0,g.Pw)((null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner)):""}`}),` ${null!==M&&void 0!==M&&M.coordinator||null!==M&&void 0!==M&&M.owner?((null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner)).fullName:""}`,(0,S.jsx)(f.A,{size:"small",onClick:e=>{var n;(0,A.d)(e),navigator.clipboard.writeText(` ${null!==M&&void 0!==M&&M.coordinator||null!==M&&void 0!==M&&M.owner?((null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner)).fullName:""} ${(null===(n=(null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner))||void 0===n?void 0:n.phone)||""}`)},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})}),(0,S.jsx)(v.A,{id:"main-contact-number",children:(0,S.jsxs)("span",{children:["MAIN CONTACT #: ",(0,S.jsx)("a",{href:null!==M&&void 0!==M&&M.coordinator||null!==M&&void 0!==M&&M.owner?`tel:${((null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner)).phone}`:void 0,target:"_blank",onClick:A.d,children:(null===(n=(null===M||void 0===M?void 0:M.coordinator)||(null===M||void 0===M?void 0:M.owner))||void 0===n?void 0:n.phone)||""})]})}),(0,S.jsx)(v.A,{id:"last-location",children:(0,S.jsxs)("span",{children:[`LAST LOCATION #: ${null===M||void 0===M?void 0:M.lastCity}`,(0,S.jsx)(f.A,{size:"small",onClick:e=>{(0,A.d)(e),navigator.clipboard.writeText(`${null===M||void 0===M?void 0:M.lastCity}`)},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,S.jsx)(a.A,{children:(0,S.jsx)(u.A,{onClick:F,children:"Close"})})]}),(0,S.jsx)(x.A,{visible:R})]})}function y(e){let{center:n,zoom:o,mapId:i,children:t}=e;const r=l.useRef(null),[d,s]=l.useState();l.useEffect((()=>{r.current&&!d&&s(new window.google.maps.Map(r.current,{center:n,zoom:o,mapId:i}))}),[r,d]);const a=l.Children.only(t);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{height:"100%",width:"100%"},ref:r,id:"map"}),l.isValidElement(a)&&l.cloneElement(a,{map:d})]})}function $(e){let{map:n,children:o}=e;const[i,t]=l.useState();return l.useEffect((()=>{if(!i&&n){const e=new r.w1({});e.setMap(n),t(e)}}),[n,i]),l.useEffect((()=>{i&&i.render()}),[n,o,i]),null===i||void 0===i||i.render(),(0,S.jsx)(S.Fragment,{children:l.Children.map(o,(e=>{if(l.isValidElement(e))return l.cloneElement(e,{map:n,clusterer:i})}))})}const N=e=>{const{onCLick:n,clusterer:o,map:i,position:t,...r}=e,[d,s]=l.useState();return l.useEffect((()=>{if(!d){const e=new window.google.maps.marker.AdvancedMarkerElement;s(e),e.addListener("click",n)}}),[d]),l.useEffect((()=>{d&&(d.map=i||null)}),[d,i]),l.useEffect((()=>{d&&(d.position=t)}),[d,t&&`${null===t||void 0===t?void 0:t.lat},${null===t||void 0===t?void 0:t.lng}`]),l.useEffect((()=>{d&&(null===o||void 0===o||o.addMarker(d,!1))}),[d,o]),l.useEffect((()=>{d&&Object.assign(d,r)}),[d,r]),null}}}]);
//# sourceMappingURL=5822.e3b66145.chunk.js.map