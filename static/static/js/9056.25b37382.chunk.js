"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[9056,8936],{9056:function(n,o,i){i.r(o),i.d(o,{default:function(){return u}});i(2791);var t=i(2917),e=i(8936),r=i(1605),l=i(344),a=i(184);function u(){var n=(0,t.a)({queryKey:["trucksForMap"],queryFn:l.vD,keepPreviousData:!1,retry:!1}),o=n.isLoading,i=n.isFetching,u=(n.data||[]).filter((function(n){return n.lastLocation}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.default,{truckListData:u}),(0,a.jsx)(r.Z,{visible:o||i})]})}},8936:function(n,o,i){i.r(o),i.d(o,{default:function(){return U}});var t=i(5987),e=i(9439),r=i(1413),l=i(2791),a=i(2917),u=i(9259),c=i(1697),d=i(5931),s=i(5574),v=i(7123),f=i(9157),p=i(4294),h=i(1691),m=i(5661),x=i(4554),g=i(3400),j=i(194),w=i(1605),Z=i(344),k=i(9063),C=i(5916),L=i(7004),E=i(4633),y=i(3026),S=i(901),b=i(184),M=["onCLick","clusterer","map","position"],N={lat:39.828922654821866,lng:-98.57947970000001},T=5,A="865ca10c27c22749",F=l.forwardRef((function(n,o){return(0,b.jsx)(d.Z,(0,r.Z)({direction:"up",ref:o},n))}));function U(n){var o,i=n.truckListData,t=N,c=T;1===i.length&&i[0].lastLocation&&(t={lat:i[0].lastLocation[0],lng:i[0].lastLocation[1]},c*=2);var d=l.useState(null),M=(0,e.Z)(d,2),U=M[0],O=M[1],R=l.useState(""),z=(0,e.Z)(R,2),P=z[0],q=z[1],G=l.useState(null),K=(0,e.Z)(G,2),V=K[0],B=K[1],W=l.useState(!1),X=(0,e.Z)(W,2),H=X[0],J=X[1],Q=(0,a.a)({queryKey:["truckForMap",P],queryFn:Z.dC,keepPreviousData:!1,retry:!1,enabled:!1}).refetch;l.useEffect((function(){if(P){J(!0);var n=null===i||void 0===i?void 0:i.find((function(n){return n.id===P})),o=n&&(null===n||void 0===n?void 0:n.lastLocation);Promise.all([Q().then((function(n){return n.data})),o&&(null===U||void 0===U?void 0:U.geocode({location:{lat:o[0],lng:o[1]}}).then((function(n){var o=(0,y.F)(n.results);return o?(0,S.u)(o.address_components):""})))]).then((function(n){var o=(0,e.Z)(n,2),i=o[0],t=o[1];B(i?(0,r.Z)((0,r.Z)({},i),{},{lastCity:t||""}):null)})).catch((function(){return B(null)})).finally((function(){return J(!1)}))}else B(null)}),[P]);var Y=function(){q("")};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(x.Z,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,b.jsx)(u.Wrapper,(0,r.Z)((0,r.Z)({},(0,E.z)()),{},{render:function(n){var o=(0,k.Ds)(),i=(0,k.U2)(),t=(0,e.Z)(i,2)[1];return l.useLayoutEffect((function(){return n===u.Status.LOADING&&t(!0),n===u.Status.FAILURE&&o({severity:"error",message:"Error loading maps!"}),n===u.Status.SUCCESS&&O(new window.google.maps.Geocoder),function(){n===u.Status.LOADING&&t(!1)}}),[n]),null}})),U?(0,b.jsx)(D,{center:t,zoom:c,mapId:A,children:(0,b.jsx)(I,{children:i.map((function(n){var o,i,t,e;return(0,b.jsx)(_,{onCLick:function(){return o=n.id,void q(o);var o},optimized:!0,animation:null===(o=window)||void 0===o||null===(i=o.google)||void 0===i||null===(t=i.maps)||void 0===t||null===(e=t.Animation)||void 0===e?void 0:e.DROP,title:"".concat(n.truckNumber,"\n").concat(n.status),position:{lat:n.lastLocation[0],lng:n.lastLocation[1]}},n.id)}))})}):null]}),(0,b.jsxs)(s.Z,{open:!!V,TransitionComponent:F,keepMounted:!0,onClose:Y,"aria-describedby":"alert-dialog-slide-description",children:[(0,b.jsx)(m.Z,{children:(0,b.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,b.jsx)("a",{href:"./trucks/view/".concat(null===V||void 0===V?void 0:V.id),target:"_blank",children:null===V||void 0===V?void 0:V.truckNumber})]})}),(0,b.jsxs)(f.Z,{children:[(0,b.jsx)(h.Z,{id:"truck-status",children:"CURRENT STATUS: ".concat(null===V||void 0===V?void 0:V.status)}),(0,b.jsx)(h.Z,{id:"main-contact",children:(0,b.jsxs)("span",{children:["MAIN CONTACT: ",(0,b.jsx)("b",{children:"".concat(null!==V&&void 0!==V&&V.coordinator||null!==V&&void 0!==V&&V.owner?(0,C.oL)((null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner)):"")})," ".concat(null!==V&&void 0!==V&&V.coordinator||null!==V&&void 0!==V&&V.owner?((null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner)).fullName:""),(0,b.jsx)(g.Z,{size:"small",onClick:function(n){var o;(0,L.U)(n),navigator.clipboard.writeText(" ".concat(null!==V&&void 0!==V&&V.coordinator||null!==V&&void 0!==V&&V.owner?((null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner)).fullName:""," ").concat((null===(o=(null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner))||void 0===o?void 0:o.phone)||""))},children:(0,b.jsx)(j.Z,{sx:{height:"16px",width:"16px"}})})]})}),(0,b.jsx)(h.Z,{id:"main-contact-number",children:(0,b.jsxs)("span",{children:["MAIN CONTACT #: ",(0,b.jsx)("a",{href:null!==V&&void 0!==V&&V.coordinator||null!==V&&void 0!==V&&V.owner?"tel:".concat(((null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner)).phone):void 0,target:"_blank",onClick:L.U,children:(null===(o=(null===V||void 0===V?void 0:V.coordinator)||(null===V||void 0===V?void 0:V.owner))||void 0===o?void 0:o.phone)||""})]})}),(0,b.jsx)(h.Z,{id:"last-location",children:(0,b.jsxs)("span",{children:["LAST LOCATION #: ".concat(null===V||void 0===V?void 0:V.lastCity),(0,b.jsx)(g.Z,{size:"small",onClick:function(n){(0,L.U)(n),navigator.clipboard.writeText("".concat(null===V||void 0===V?void 0:V.lastCity))},children:(0,b.jsx)(j.Z,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,b.jsx)(v.Z,{children:(0,b.jsx)(p.Z,{onClick:Y,children:"Close"})})]}),(0,b.jsx)(w.Z,{visible:H})]})}function D(n){var o=n.center,i=n.zoom,t=n.mapId,r=n.children,a=l.useRef(null),u=l.useState(),c=(0,e.Z)(u,2),d=c[0],s=c[1];l.useEffect((function(){a.current&&!d&&s(new window.google.maps.Map(a.current,{center:o,zoom:i,mapId:t}))}),[a,d]);var v=l.Children.only(r);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{height:"100%",width:"100%"},ref:a,id:"map"}),l.isValidElement(v)&&l.cloneElement(v,{map:d})]})}function I(n){var o=n.map,i=n.children,t=l.useState(),r=(0,e.Z)(t,2),a=r[0],u=r[1];return l.useEffect((function(){return a||u(new c.XL({})),function(){a&&a.setMap(null)}}),[a]),l.useEffect((function(){a&&o&&a.setMap(o)}),[o]),l.useEffect((function(){a&&a.render()}),[o,i]),null===a||void 0===a||a.render(),(0,b.jsx)(b.Fragment,{children:l.Children.map(i,(function(n){if(l.isValidElement(n))return l.cloneElement(n,{map:o,clusterer:a})}))})}var _=function(n){var o=n.onCLick,i=n.clusterer,r=n.map,a=n.position,u=(0,t.Z)(n,M),c=l.useState(),d=(0,e.Z)(c,2),s=d[0],v=d[1];return l.useEffect((function(){if(!s){var n=new window.google.maps.Marker;v(n),n.addListener("click",o)}return function(){s&&(s.setMap(null),null===i||void 0===i||i.removeMarker(s,!1))}}),[s]),l.useEffect((function(){s&&s.setMap(r||null)}),[s,r]),l.useEffect((function(){s&&s.setPosition(a)}),[s,a&&"".concat(null===a||void 0===a?void 0:a.lat,",").concat(null===a||void 0===a?void 0:a.lng)]),l.useEffect((function(){s&&(null===i||void 0===i||i.addMarker(s,!1))}),[s,i]),l.useEffect((function(){s&&s.setOptions(u)}),[s,u]),null}},7004:function(n,o,i){function t(n){n.stopPropagation()}i.d(o,{U:function(){return t}})}}]);
//# sourceMappingURL=9056.25b37382.chunk.js.map