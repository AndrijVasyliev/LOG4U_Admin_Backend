"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[5822],{5822:(n,e,o)=>{o.r(e),o.d(e,{default:()=>b});var t=o(5043),i=o(5604),l=o(5563),r=o(237),d=o(4836),s=o(3462),a=o(9347),c=o(5316),u=o(1906),v=o(8533),h=o(6600),p=o(6446),f=o(7392),m=o(4914),x=o(8612),w=o(1079),j=o(9056),g=o(6431),A=o(7166),k=o(5552),C=o(4133),E=o(9129),S=o(579);const L=t.forwardRef((function(n,e){return(0,S.jsx)(d.A,{direction:"up",ref:e,...n})}));function b(n){var e;let{truckListData:o}=n,r=k.gX,d=k.s_;1===o.length&&o[0].lastLocation&&(r={lat:o[0].lastLocation[0],lng:o[0].lastLocation[1]},d*=2);const[b,I]=t.useState(null),[_,M]=t.useState(""),[O,R]=t.useState(null),[U,z]=t.useState(!1),{refetch:F}=(0,i.I)({queryKey:["truckForMap",_],queryFn:w.k$,keepPreviousData:!1,retry:!1,enabled:!1});t.useEffect((()=>{if(_){z(!0);const n=null===o||void 0===o?void 0:o.find((n=>n.id===_)),e=n&&(null===n||void 0===n?void 0:n.lastLocation);Promise.all([F().then((n=>n.data)),e&&((null===b||void 0===b?void 0:b.geocode({location:{lat:e[0],lng:e[1]}}))||Promise.reject()).then((n=>{const e=(0,C.U)(n.results);return e?(0,E.s)(e.address_components):""}))]).then((n=>{let[e,o]=n;R(e?{...e,lastCity:o||""}:null)})).catch((()=>R(null))).finally((()=>z(!1)))}else R(null)}),[_]);const P=()=>{M("")};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(p.A,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,S.jsx)(l.Wrapper,{...(0,k.iz)(),render:n=>{const e=(0,j.dh)(),[,o]=(0,j.pn)();return t.useLayoutEffect((()=>(n===l.Status.LOADING&&o(!0),n===l.Status.FAILURE&&e({severity:"error",message:"Error loading maps!"}),n===l.Status.SUCCESS&&I(new window.google.maps.Geocoder),()=>{n===l.Status.LOADING&&o(!1)})),[n]),null}}),b?(0,S.jsx)(y,{center:r,zoom:d,mapId:k.yw,children:(0,S.jsx)(N,{children:o.map((n=>(0,S.jsx)(T,{onCLick:()=>{return e=n.id,void M(e);var e},title:"".concat(n.truckNumber,"\n").concat(n.status),position:{lat:n.lastLocation[0],lng:n.lastLocation[1]}},n.id)))})}):null]}),(0,S.jsxs)(s.A,{open:!!O,TransitionComponent:L,keepMounted:!0,onClose:P,"aria-describedby":"alert-dialog-slide-description",children:[(0,S.jsx)(h.A,{children:(0,S.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,S.jsx)("a",{href:"./trucks/view/".concat(null===O||void 0===O?void 0:O.id),target:"_blank",children:null===O||void 0===O?void 0:O.truckNumber})]})}),(0,S.jsxs)(c.A,{children:[(0,S.jsx)(v.A,{id:"truck-status",children:"CURRENT STATUS: ".concat(null===O||void 0===O?void 0:O.status)}),(0,S.jsx)(v.A,{id:"main-contact",children:(0,S.jsxs)("span",{children:["MAIN CONTACT: ",(0,S.jsx)("b",{children:"".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?(0,g.Pw)((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)):"")})," ".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).fullName:""),(0,S.jsx)(f.A,{size:"small",onClick:n=>{var e;(0,A.d)(n),navigator.clipboard.writeText(" ".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).fullName:""," ").concat((null===(e=(null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner))||void 0===e?void 0:e.phone)||""))},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})}),(0,S.jsx)(v.A,{id:"main-contact-number",children:(0,S.jsxs)("span",{children:["MAIN CONTACT #: ",(0,S.jsx)("a",{href:null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?"tel:".concat(((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).phone):void 0,target:"_blank",onClick:A.d,children:(null===(e=(null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner))||void 0===e?void 0:e.phone)||""})]})}),(0,S.jsx)(v.A,{id:"last-location",children:(0,S.jsxs)("span",{children:["LAST LOCATION #: ".concat(null===O||void 0===O?void 0:O.lastCity),(0,S.jsx)(f.A,{size:"small",onClick:n=>{(0,A.d)(n),navigator.clipboard.writeText("".concat(null===O||void 0===O?void 0:O.lastCity))},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,S.jsx)(a.A,{children:(0,S.jsx)(u.A,{onClick:P,children:"Close"})})]}),(0,S.jsx)(x.A,{visible:U})]})}function y(n){let{center:e,zoom:o,mapId:i,children:l}=n;const r=t.useRef(null),[d,s]=t.useState();t.useEffect((()=>{r.current&&!d&&s(new window.google.maps.Map(r.current,{center:e,zoom:o,mapId:i}))}),[r,d]);const a=t.Children.only(l);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{height:"100%",width:"100%"},ref:r,id:"map"}),t.isValidElement(a)&&t.cloneElement(a,{map:d})]})}function N(n){let{map:e,children:o}=n;const[i,l]=t.useState();return t.useEffect((()=>{if(!i&&e){const n=new r.w1({});n.setMap(e),l(n)}}),[e,i]),t.useEffect((()=>{i&&i.render()}),[e,o,i]),null===i||void 0===i||i.render(),(0,S.jsx)(S.Fragment,{children:t.Children.map(o,(n=>{if(t.isValidElement(n))return t.cloneElement(n,{map:e,clusterer:i})}))})}const T=n=>{const{onCLick:e,clusterer:o,map:i,position:l,...r}=n,[d,s]=t.useState();return t.useEffect((()=>{if(!d){const n=new window.google.maps.marker.AdvancedMarkerElement;s(n),n.addListener("click",e)}}),[d]),t.useEffect((()=>{d&&(d.map=i||null)}),[d,i]),t.useEffect((()=>{d&&(d.position=l)}),[d,l&&"".concat(null===l||void 0===l?void 0:l.lat,",").concat(null===l||void 0===l?void 0:l.lng)]),t.useEffect((()=>{d&&(null===o||void 0===o||o.addMarker(d,!1))}),[d,o]),t.useEffect((()=>{d&&Object.assign(d,r)}),[d,r]),null}},7166:(n,e,o)=>{function t(n){n.stopPropagation()}o.d(e,{d:()=>t})}}]);
//# sourceMappingURL=5822.ac87fde2.chunk.js.map