"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[568],{7273:function(e,r,t){t.d(r,{Z:function(){return C}});var n=t(9439),i=t(2791),a=t(6403),s=t(2917),o=t(3418),l=t(344),c=t(4554),u=t(1473),d=t(5818),f=t(3721),m=t(890),p=t(1889),x=t(6759),b=t(6934),h=t(3400),g=t(2913),v=t(9063),y=t(1605),k=t(4165),j=t(5861),Z=t(5527),E=t(3239),N=t(383),T=t(184);function S(e){var r=e.file,t=e.disabled,s=void 0!==t&&t,u=i.useState(""),d=(0,n.Z)(u,2),f=d[0],m=d[1],p=i.useState(!1),x=(0,n.Z)(p,2),b=x[0],g=x[1],S=(0,a.NL)(),R=(0,v.Ds)(),I=(0,v.MZ)(),C=(0,n.Z)(I,2)[1],L=(0,o.D)(l.mg,{onSuccess:function(){R({severity:"success",message:"Deleted"}),S.invalidateQueries(["file"])},onError:function(e){R({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),w=L.mutate,O=L.isLoading;i.useEffect((function(){var e;return(0,j.Z)((0,k.Z)().mark((function t(){var n;return(0,k.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(!0),t.next=3,(0,l.mZ)(r.id);case 3:n=t.sent,g(!1),e=URL.createObjectURL(n),m(e);case 7:case"end":return t.stop()}}),t)})))(),function(){e&&URL.revokeObjectURL(e)}}),[]);var q=function(){var e=(0,j.Z)((0,k.Z)().mark((function e(t){var n,i;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,window.showSaveFilePicker({suggestedName:r.filename});case 4:n=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:if(n){e.next=11;break}return e.abrupt("return");case 11:return e.prev=11,e.next=14,n.createWritable();case 14:return i=e.sent,e.next=17,(0,l.HY)(r.id);case 17:return e.next=19,e.sent.pipeTo(i);case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(11),R({severity:"error",message:e.t1 instanceof Error?e.t1.message:JSON.stringify(e.t1)});case 24:case"end":return e.stop()}}),e,null,[[1,7],[11,21]])})));return function(r){return e.apply(this,arguments)}}();return(0,T.jsxs)(Z.Z,{sx:{height:"240px",width:"210px",backgroundColor:"unset"},children:[(0,T.jsxs)(c.Z,{sx:{width:"100%",padding:"5px",display:"flex",justifyContent:"space-between"},children:[(0,T.jsx)("a",{href:"#",target:"_blank",onClick:q,style:{textOverflow:"ellipsis",overflow:"hidden"},children:"".concat(r.comment?r.comment:r.filename)}),(0,T.jsx)(h.Z,{"aria-label":"delete file",onClick:function(){confirm("Are you sure you want to delete file")&&w("".concat(r.id))},sx:{padding:0},disabled:s,children:(0,T.jsx)(N.Z,{})})]}),f?(0,T.jsx)("img",{src:f,height:"200px",width:"200px",style:{margin:"auto",display:"block"},alt:"".concat(r.filename),onClick:function(){f&&C(f)}}):null,b?(0,T.jsx)(E.Z,{sx:{display:"block",margin:"auto",marginTop:"50px"}}):null,(0,T.jsx)(y.Z,{visible:O})]})}var R=30,I=(0,b.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function C(e){var r=e.objectId,t=e.objectType,b=e.disabled,k=void 0!==b&&b,j=i.useState(!1),Z=(0,n.Z)(j,2),E=Z[0],N=Z[1],C=(0,a.NL)(),L=(0,v.Ds)(),w={};switch(t){case"Person":w.person=r||"";break;case"Truck":w.truck=r||"";break;case"Load":w.load=r||""}var O=(0,s.a)({queryKey:["file",0,R,void 0,void 0,w],queryFn:l.dZ,keepPreviousData:!1,retry:!1,enabled:E,onError:function(e){L({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),q=O.isLoading,A=O.isFetching,P=O.data,D=void 0===P?{items:[],total:0}:P,B=D.items,F=(D.total,B||[]),_=(0,o.D)(l.p0,{onSuccess:function(){L({severity:"success",message:"Uploaded"}),C.invalidateQueries(["file"])},onError:function(e){L({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),U=_.mutate;_.isLoading;return(0,T.jsxs)(c.Z,{sx:{},children:[(0,T.jsxs)(u.Z,{expanded:E,onChange:function(){N((function(e){return!e}))},sx:{backgroundColor:"unset"},children:[(0,T.jsx)(d.Z,{expandIcon:(0,T.jsx)(x.Z,{}),"aria-controls":"panel2-content",id:"panel2-header",children:(0,T.jsxs)(c.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,T.jsx)(m.Z,{children:"File list"}),(0,T.jsxs)(h.Z,{component:"label","aria-label":"add file",sx:{padding:0},disabled:k,children:[(0,T.jsx)(g.Z,{}),(0,T.jsx)(I,{type:"file",onChange:function(e){var n,i,a=(null===e||void 0===e||null===(n=e.currentTarget)||void 0===n?void 0:n.files)&&(null===e||void 0===e||null===(i=e.currentTarget)||void 0===i?void 0:i.files[0]);if(a&&r&&t){var s=prompt("Enter file description"),o=new FormData;o.append("file",a),o.append("fileOf",t),o.append("linkedTo",r),s&&o.append("comment",s),U(o)}}})]})]})}),(0,T.jsx)(f.Z,{children:E?(0,T.jsx)(p.ZP,{container:!0,spacing:{xs:2,md:3,xl:4},columns:{xs:4,sm:8,md:12,lg:12,xl:12},children:F.map((function(e){return(0,T.jsx)(p.ZP,{item:!0,xs:4,sm:4,md:5,lg:3,xl:2,children:(0,T.jsx)(S,{file:e,disabled:k})},e.id)}))}):null})]}),(0,T.jsx)(y.Z,{visible:E&&(A||q)})]})}},568:function(e,r,t){t.r(r),t.d(r,{default:function(){return N}});var n=t(1413),i=(t(2791),t(7689)),a=t(6403),s=t(2917),o=t(3418),l=t(5705),c=t(8007),u=t(4554),d=t(4294),f=t(9524),m=t(9111),p=t(501),x=t(5371),b=t(344),h=t(9063),g=t(2835),v=t(5916),y=t(7273),k=t(4721),j=t(184),Z=c.Ry({status:c.Z_().oneOf(g.q6).required("Status is required"),weight:c.Z_().required("Weight is required"),truckType:c.IX(c.Z_().oneOf(g.Gm)).min(1,"Select at list one").required("Truck Type is required"),rate:c.Rx().typeError("Rate must be a number"),totalCharges:c.Rx().typeError("Total charges must be a number"),currency:c.Z_().required("Currency is required"),bookedByUser:c.Ry({id:c.Z_().required()}).typeError("Enter correct user").nullable(),bookedByCompany:c.Z_(),assignTo:c.IX(c.Ry({id:c.Z_().required()}).typeError("Enter correct user")),checkInAs:c.Z_(),truck:c.Ry({id:c.Z_().required()}).typeError("Enter correct truck").nullable(),bookedWith:c.Ry({id:c.Z_().required()}).typeError("Enter correct customer").nullable()}),E={id:"",status:"Available",weight:void 0,truckType:[],rate:void 0,totalCharges:void 0,currency:"USD",bookedByUser:null,bookedByCompany:void 0,assignTo:[],checkInAs:"4ULogistics",truck:null,bookedWith:null};function N(){var e=(0,i.TH)().pathname,r=(0,i.s0)(),t=(0,a.NL)(),c=(0,h.Ds)(),N=(0,s.a)({queryKey:["user",e.split("/")[3]],queryFn:b.vl,keepPreviousData:!0,retry:!1,onError:function(e){c({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),T=N.isLoading,S=N.isFetching,R=N.data,I=(0,o.D)(b.WE,{onSuccess:function(){c({severity:"success",message:"Saved"}),t.invalidateQueries(["loads"]),r(-1)},onError:function(e){c({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),C=I.mutate,L=I.isLoading,w=(0,l.TA)({initialValues:(0,n.Z)((0,n.Z)({},E),(0,v.sW)(R,Object.keys(E))),enableReinitialize:!0,validationSchema:Z,onSubmit:function(e){C(e)}});return(0,j.jsxs)(u.Z,{sx:{height:"100%"},children:[(0,j.jsx)("form",{onSubmit:w.handleSubmit,onReset:w.handleReset,style:{height:"100%"},children:(0,j.jsxs)(u.Z,{sx:{p:3,height:"100%"},children:[(0,j.jsx)(k.Z,{}),(0,j.jsxs)(u.Z,{sx:{maxHeight:"calc(100% - 70px)",overflowX:"hidden",overflowY:"scroll"},children:[(0,j.jsxs)(u.Z,{sx:{display:"inline-flex",width:"100%"},children:[(0,j.jsxs)(u.Z,{sx:{p:1,width:"50%"},children:[(0,j.jsx)(x.mg,{fieldName:"status",label:"Status",items:g.q6,formik:w}),(0,j.jsx)(x.nv,{fieldName:"weight",label:"Weight",formik:w}),(0,j.jsx)(x.O6,{fieldName:"truckType",label:"Truck Type",items:g.Gm,formik:w}),(0,j.jsx)(x.Um,{fieldName:"bookedByUser",label:"Booked By",getSelectedLabel:function(e){return"".concat(e.fullName)},getItemLabel:function(e){return"".concat(e.fullName)},getItemSecondLabel:function(e){return"".concat(e.jobTitle)},ListIcon:p.Z,queryFn:b.np,orderby:"fullName",order:"asc",formik:w})]},"left"),(0,j.jsxs)(u.Z,{sx:{p:1,width:"50%"},children:[(0,j.jsx)(x.nv,{fieldName:"rate",label:"Rate",number:!0,formik:w}),(0,j.jsx)(x.nv,{fieldName:"totalCharges",label:"Total Charges",number:!0,formik:w}),(0,j.jsx)(x.nv,{fieldName:"currency",label:"Currency",formik:w}),(0,j.jsx)(x.nv,{fieldName:"checkInAs",label:"Check In As",formik:w}),(0,j.jsx)(x.nv,{fieldName:"bookedByCompany",label:"Booked By Company",formik:w})]},"right")]},"centerControls"),(0,j.jsxs)(u.Z,{sx:{marginTop:-2,marginBottom:3,p:1},children:[(0,j.jsx)(x.nv,{fieldName:"ref",label:"REF",multiline:!0,maxRows:3,formik:w}),(0,j.jsx)(x.Um,{fieldName:"truck",label:"Truck",getSelectedLabel:function(e){return"".concat(e.truckNumber)},getItemLabel:function(e){return"".concat(e.truckNumber)},getItemSecondLabel:function(e){return"".concat(e.status,", ").concat(e.licencePlate)},ListIcon:f.Z,queryFn:b.g7,orderby:"truckNumber",order:"asc",formik:w}),(0,j.jsx)(x.Um,{fieldName:"bookedWith",label:"Booked With",getSelectedLabel:function(e){return"".concat(e.name)},getItemLabel:function(e){return"".concat(e.name)},getItemSecondLabel:function(e){return"".concat(e.type)},ListIcon:m.Z,queryFn:b.jO,orderby:"name",order:"asc",formik:w}),(0,j.jsx)(x.Go,{fieldName:"assignTo",label:"Assign To",getSelectedLabel:function(e){return"".concat(e.fullName)},getItemLabel:function(e){return"".concat(e.fullName)},getItemSecondLabel:function(e){return"".concat(e.jobTitle)},ListIcon:p.Z,queryFn:b.np,orderby:"fullName",order:"asc",formik:w}),(0,j.jsx)(y.Z,{objectId:null===R||void 0===R?void 0:R.id,objectType:"Load"})]},"bottomControls")]},"controls"),(0,j.jsx)(k.Z,{}),(0,j.jsxs)(u.Z,{sx:{paddingTop:3,display:"flex"},children:[(0,j.jsx)(u.Z,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,j.jsx)(d.Z,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"submit",disabled:!w.dirty,children:"Save"})},"left"),(0,j.jsx)(u.Z,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,j.jsx)(d.Z,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"button",onClick:function(){r(-1)},children:"Cancel"})},"right")]},"buttons")]})}),(0,j.jsx)(x.aN,{visible:L||T||S})]})}},2835:function(e,r,t){t.d(r,{Ep:function(){return u},Gm:function(){return s},Hz:function(){return l},I2:function(){return a},KN:function(){return o},V3:function(){return n},fg:function(){return c},q6:function(){return d},vX:function(){return i}});var n=["EN","UA","ES","RU"],i=["Admin","Super Admin"],a=["BROKER DOMESTIC","BROKER INTERNATIONAL","FREIGHT FORWARDER DOMESTIC","FREIGHT FORWARDER INTERNATIONAL","SHIPPER/CONSIGNEE DOMESTIC","SHIPPER/CONSIGNEE INTERNATIONAL","OTHER"],s=["Cargo van","Reefer van","Box truck","Box truck Reefer","Straight truck","Hotshot","Tented box"],o=["Available","Not Available","Will be available","On route"],l=["Yes","No"],c=["Hazmat","Tsa","TWIC","Tanker Endorsement"],u=["Dock height risers","Air ride","Lift gate","Keep from freezing","ICC bar","Vertical E-track","Horizontal E-track","Pallet jack","PPE","Ramps","Straps","Loads bars","Blankets","Pads","Fire extinguisher","Metal hooks","Reefer","Heater"],d=["Available","Planned","In Progress","TONU","Cancelled","Completed"]},501:function(e,r,t){var n=t(4836);r.Z=void 0;var i=n(t(5649)),a=t(184),s=(0,i.default)((0,a.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");r.Z=s}}]);
//# sourceMappingURL=568.f28d9703.chunk.js.map