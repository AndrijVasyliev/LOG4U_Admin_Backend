"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[568],{7273:function(e,r,t){t.d(r,{Z:function(){return E}});var i=t(9439),n=t(2791),a=t(6403),o=t(2917),s=t(3418),c=t(344),l=t(4554),d=t(1473),u=t(5818),f=t(3721),m=t(890),p=t(1889),b=t(6759),h=t(6934),x=t(3400),g=t(2913),y=t(9063),v=t(1605),k=t(4165),j=t(5861),Z=t(5527),N=t(3239),T=t(383),F=t(184);function q(e){var r=e.file,t=e.disabled,o=void 0!==t&&t,d=n.useState(""),u=(0,i.Z)(d,2),f=u[0],m=u[1],p=n.useState(!1),b=(0,i.Z)(p,2),h=b[0],g=b[1],q=(0,a.NL)(),S=(0,y.Ds)(),w=(0,y.MZ)(),E=(0,i.Z)(w,2)[1],I=(0,s.D)(c.mg,{onSuccess:function(){S({severity:"success",message:"Deleted"}),q.invalidateQueries(["file"])},onError:function(e){S({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),C=I.mutate,L=I.isLoading;n.useEffect((function(){var e;return(0,j.Z)((0,k.Z)().mark((function t(){var i;return(0,k.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(!0),t.next=3,(0,c.mZ)(r.id);case 3:i=t.sent,g(!1),e=URL.createObjectURL(i),m(e);case 7:case"end":return t.stop()}}),t)})))(),function(){e&&URL.revokeObjectURL(e)}}),[]);var R=function(){var e=(0,j.Z)((0,k.Z)().mark((function e(t){var i,n;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,window.showSaveFilePicker({suggestedName:r.filename});case 4:i=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:if(i){e.next=11;break}return e.abrupt("return");case 11:return e.prev=11,e.next=14,i.createWritable();case 14:return n=e.sent,e.next=17,(0,c.HY)(r.id);case 17:return e.next=19,e.sent.pipeTo(n);case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(11),S({severity:"error",message:e.t1 instanceof Error?e.t1.message:JSON.stringify(e.t1)});case 24:case"end":return e.stop()}}),e,null,[[1,7],[11,21]])})));return function(r){return e.apply(this,arguments)}}();return(0,F.jsxs)(Z.Z,{sx:{height:"240px",width:"210px",backgroundColor:"unset"},children:[(0,F.jsxs)(l.Z,{sx:{width:"100%",padding:"5px",display:"flex",justifyContent:"space-between"},children:[(0,F.jsx)("a",{href:"#",target:"_blank",onClick:R,style:{textOverflow:"ellipsis",overflow:"hidden"},children:"".concat(r.comment?r.comment:r.filename)}),(0,F.jsx)(x.Z,{"aria-label":"delete file",onClick:function(){confirm("Are you sure you want to delete file")&&C("".concat(r.id))},sx:{padding:0},disabled:o,children:(0,F.jsx)(T.Z,{})})]}),f?(0,F.jsx)("img",{src:f,height:"200px",width:"200px",style:{margin:"auto",display:"block"},alt:"".concat(r.filename),onClick:function(){f&&E(f)}}):null,h?(0,F.jsx)(N.Z,{sx:{display:"block",margin:"auto",marginTop:"50px"}}):null,(0,F.jsx)(v.Z,{visible:L})]})}var S=30,w=(0,h.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function E(e){var r=e.objectId,t=e.objectType,h=e.disabled,k=void 0!==h&&h,j=n.useState(!1),Z=(0,i.Z)(j,2),N=Z[0],T=Z[1],E=(0,a.NL)(),I=(0,y.Ds)(),C={};switch(t){case"Person":C.person=r||"";break;case"Truck":C.truck=r||"";break;case"Load":C.load=r||""}var L=(0,o.a)({queryKey:["file",0,S,void 0,void 0,C],queryFn:c.dZ,keepPreviousData:!1,retry:!1,enabled:N,onError:function(e){I({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),R=L.isLoading,O=L.isFetching,P=L.data,A=void 0===P?{items:[],total:0}:P,D=A.items,U=(A.total,D||[]),_=(0,s.D)(c.p0,{onSuccess:function(){I({severity:"success",message:"Uploaded"}),E.invalidateQueries(["file"])},onError:function(e){I({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),B=_.mutate;_.isLoading;return(0,F.jsxs)(l.Z,{sx:{},children:[(0,F.jsxs)(d.Z,{expanded:N,onChange:function(){T((function(e){return!e}))},sx:{backgroundColor:"unset"},children:[(0,F.jsx)(u.Z,{expandIcon:(0,F.jsx)(b.Z,{}),"aria-controls":"panel2-content",id:"panel2-header",children:(0,F.jsxs)(l.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,F.jsx)(m.Z,{children:"File list"}),(0,F.jsxs)(x.Z,{component:"label","aria-label":"add file",sx:{padding:0},disabled:k,children:[(0,F.jsx)(g.Z,{}),(0,F.jsx)(w,{type:"file",onChange:function(e){var i,n,a=(null===e||void 0===e||null===(i=e.currentTarget)||void 0===i?void 0:i.files)&&(null===e||void 0===e||null===(n=e.currentTarget)||void 0===n?void 0:n.files[0]);if(a&&r&&t){var o=prompt("Enter file description"),s=new FormData;s.append("file",a),s.append("fileOf",t),s.append("linkedTo",r),o&&s.append("comment",o),B(s)}}})]})]})}),(0,F.jsx)(f.Z,{children:N?(0,F.jsx)(p.ZP,{container:!0,spacing:{xs:2,md:3,xl:4},columns:{xs:4,sm:8,md:12,lg:12,xl:12},children:U.map((function(e){return(0,F.jsx)(p.ZP,{item:!0,xs:4,sm:4,md:5,lg:3,xl:2,children:(0,F.jsx)(q,{file:e,disabled:k})},e.id)}))}):null})]}),(0,F.jsx)(v.Z,{visible:N&&(O||R)})]})}},568:function(e,r,t){t.r(r),t.d(r,{default:function(){return L}});var i=t(1413),n=t(9439),a=t(2791),o=t(7689),s=t(6403),c=t(2917),l=t(3418),d=t(5705),u=t(8007),f=t(4554),m=t(4294),p=t(4721),b=t(9524),h=t(9111),x=t(501),g=t(6745),y=t(5371),v=t(344),k=t(9063),j=t(2835),Z=t(5916),N=t(7273),T=t(184),F=u.Ry({type:u.Z_().oneOf([j.dw.FCFS,j.dw.ASAP,j.dw.APPT]).required("Type is required"),at:u.hT().when(["type"],(function(e,r){return e[0]===j.dw.FCFS?r.oneOf([void 0]):r.required("At is required")})),from:u.hT().when(["type"],(function(e,r){return e[0]!==j.dw.FCFS?r.oneOf([void 0]):r.required("From is required")})),to:u.hT().when(["type"],(function(e,r){return e[0]!==j.dw.FCFS?r.oneOf([void 0]):r.required("To is required")}))}),q=u.Ry({type:u.Z_().oneOf([j.dw.FCFS,j.dw.Direct,j.dw.APPT]).required("Type is required"),at:u.hT().when(["type"],(function(e,r){return e[0]===j.dw.FCFS?r.oneOf([void 0]):r.required("At is required")})),from:u.hT().when(["type"],(function(e,r){return e[0]!==j.dw.FCFS?r.oneOf([void 0]):r.required("From is required")})),to:u.hT().when(["type"],(function(e,r){return e[0]!==j.dw.FCFS?r.oneOf([void 0]):r.required("To is required")}))}),S=u.Ry({pieces:u.Rx().integer().min(1).required("Pieces must be at least 1"),unitOfWeight:u.Z_().oneOf(j.tt).required("Unit of weight is required"),weight:u.Rx().moreThan(0).required("Weight is required"),unitOfLength:u.Z_().oneOf(j.oh).required("Unit of length is required"),length:u.Rx().moreThan(0).required("Length is required")}),w=u.Ry({facility:u.Ry({id:u.Z_().required()}).typeError("Enter correct facility").required("Facility is required"),timeFrame:F.required("Time frame is required"),freightList:u.IX().of(S.required("Freight is required")).required("Stop pickup must contain al least one freight"),addInfo:u.Z_()}),E=u.Ry({facility:u.Ry({id:u.Z_().required()}).typeError("Enter correct facility").required("Facility is required"),timeFrame:q.required("Time frame is required"),addInfo:u.Z_()}),I=u.Ry({status:u.Z_().oneOf(j.q6).required("Status is required"),ref:u.IX().of(u.Z_().required("Ref must not be empty")).max(3),stops:u.IX().of(u.Vo((function(e){switch(e.type){case j.xn.PickUp:return w.required("Stop pickup is required");case j.xn.Delivery:return E.required("Stop delivery is required");default:return u.nK().oneOf([void 0]).required('Type of stop must be "Pick Up" or "Delivery"')}}))).min(2).required("Stops are required"),weight:u.Z_().required("Weight is required"),truckType:u.IX(u.Z_().oneOf(j.Gm)).min(1,"Select at list one").required("Truck Type is required"),rate:u.Rx().typeError("Rate must be a number"),totalCharges:u.Rx().typeError("Total charges must be a number"),currency:u.Z_().required("Currency is required"),bookedByUser:u.Ry({id:u.Z_().required()}).typeError("Enter correct user").nullable(),bookedByCompany:u.Z_(),assignTo:u.IX(u.Ry({id:u.Z_().required()}).typeError("Enter correct user")),checkInAs:u.Z_(),truck:u.Ry({id:u.Z_().required()}).typeError("Enter correct truck").nullable(),bookedWith:u.Ry({id:u.Z_().required()}).typeError("Enter correct customer").nullable()}),C={id:"",status:"Available",ref:[],stops:[],weight:void 0,truckType:[],rate:void 0,totalCharges:void 0,currency:"USD",bookedByUser:null,bookedByCompany:void 0,assignTo:[],checkInAs:"4ULogistics",truck:null,bookedWith:null};function L(){var e=a.useState(C),r=(0,n.Z)(e,2),t=r[0],u=r[1],F=(0,o.TH)().pathname,q=(0,o.s0)(),S=(0,s.NL)(),w=(0,k.Ds)(),E=(0,c.a)({queryKey:["user",F.split("/")[3]],queryFn:v.vl,keepPreviousData:!0,retry:!1,onError:function(e){w({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),L=E.isLoading,R=E.isFetching,O=E.data,P=(0,l.D)(v.WE,{onSuccess:function(){w({severity:"success",message:"Saved"}),S.invalidateQueries(["loads"]),q(-1)},onError:function(e){w({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),A=P.mutate,D=P.isLoading,U=(0,d.TA)({initialValues:t,enableReinitialize:!0,validationSchema:I,onSubmit:function(e){A(e)}});a.useEffect((function(){u((0,i.Z)((0,i.Z)({},t),(0,Z.sW)(O,Object.keys(t))))}),[O]);return(0,T.jsxs)(f.Z,{sx:{height:"100%"},children:[(0,T.jsx)("form",{onSubmit:U.handleSubmit,onReset:U.handleReset,style:{height:"100%"},children:(0,T.jsxs)(f.Z,{sx:{p:3,height:"100%"},children:[(0,T.jsx)(p.Z,{}),(0,T.jsxs)(f.Z,{sx:{maxHeight:"calc(100% - 70px)",overflowX:"hidden",overflowY:"scroll"},children:[(0,T.jsxs)(f.Z,{sx:{marginBottom:-1,p:1},children:[(0,T.jsx)(y.mg,{fieldName:"status",label:"Status",items:j.q6,formik:U}),(0,T.jsx)(y.nv,{fieldName:"ref",label:"REF",multiline:!0,maxRows:3,formik:U}),(0,T.jsx)(g.Z,{fieldName:"stops",formik:U})]},"topControls"),(0,T.jsxs)(f.Z,{sx:{display:"inline-flex",width:"100%"},children:[(0,T.jsxs)(f.Z,{sx:{p:1,width:"50%"},children:[(0,T.jsx)(y.nv,{fieldName:"weight",label:"Weight",formik:U}),(0,T.jsx)(y.O6,{fieldName:"truckType",label:"Truck Type",items:j.Gm,formik:U}),(0,T.jsx)(y.Um,{fieldName:"bookedByUser",label:"Booked By",getSelectedLabel:function(e){return"".concat(e.fullName)},getItemLabel:function(e){return"".concat(e.fullName)},getItemSecondLabel:function(e){return"".concat(e.jobTitle)},ListIcon:x.Z,queryFn:v.np,orderby:"fullName",order:"asc",formik:U}),(0,T.jsx)(y.Um,{fieldName:"bookedWith",label:"Booked With",getSelectedLabel:function(e){return"".concat(e.name)},getItemLabel:function(e){return"".concat(e.name)},getItemSecondLabel:function(e){return"".concat(e.type)},ListIcon:h.Z,queryFn:v.jO,orderby:"name",order:"asc",formik:U}),(0,T.jsx)(y.Um,{fieldName:"truck",label:"Truck",getSelectedLabel:function(e){return"".concat(e.truckNumber)},getItemLabel:function(e){return"".concat(e.truckNumber)},getItemSecondLabel:function(e){return"".concat(e.status,", ").concat(e.licencePlate)},ListIcon:b.Z,queryFn:v.g7,orderby:"truckNumber",order:"asc",formik:U})]},"left"),(0,T.jsxs)(f.Z,{sx:{p:1,width:"50%"},children:[(0,T.jsx)(y.nv,{fieldName:"rate",label:"Rate",number:!0,formik:U}),(0,T.jsx)(y.nv,{fieldName:"totalCharges",label:"Total Charges",number:!0,formik:U}),(0,T.jsx)(y.nv,{fieldName:"currency",label:"Currency",formik:U}),(0,T.jsx)(y.nv,{fieldName:"checkInAs",label:"Check In As",formik:U}),(0,T.jsx)(y.nv,{fieldName:"bookedByCompany",label:"Booked By Company",formik:U})]},"right")]},"centerControls"),(0,T.jsxs)(f.Z,{sx:{p:1,paddingBottom:0,paddingTop:0},children:[(0,T.jsx)(y.Go,{fieldName:"assignTo",label:"Assign To",getSelectedLabel:function(e){return"".concat(e.fullName)},getItemLabel:function(e){return"".concat(e.fullName)},getItemSecondLabel:function(e){return"".concat(e.jobTitle)},ListIcon:x.Z,queryFn:v.np,orderby:"fullName",order:"asc",formik:U}),(0,T.jsx)(f.Z,{sx:{paddingBottom:2,paddingTop:2}},"spacer"),(0,T.jsx)(N.Z,{objectId:null===O||void 0===O?void 0:O.id,objectType:"Load"})]},"bottomControls")]},"controls"),(0,T.jsx)(p.Z,{}),(0,T.jsxs)(f.Z,{sx:{paddingTop:3,display:"flex"},children:[(0,T.jsx)(f.Z,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,T.jsx)(m.Z,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"submit",disabled:!U.dirty,children:"Save"})},"left"),(0,T.jsx)(f.Z,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,T.jsx)(m.Z,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"button",onClick:function(){q(-1)},children:"Cancel"})},"right")]},"buttons")]})}),(0,T.jsx)(y.aN,{visible:D||L||R})]})}},6745:function(e,r,t){t.d(r,{Z:function(){return b}});var i=t(2791),n=t(6181),a=t.n(n),o=t(9283),s=t(5371),c=t(2835),l=t(184);function d(e){var r=e.fieldName,t=e.values,n=e.disabled,o=e.formik,d=a()(o.values,r);return i.useEffect((function(){d.type===c.dw.FCFS?(d.at&&o.setFieldValue("".concat(r,".at"),void 0),!d.from&&o.setFieldValue("".concat(r,".from"),null),!d.to&&o.setFieldValue("".concat(r,".to"),null)):d.type&&(!d.at&&o.setFieldValue("".concat(r,".at"),null),d.from&&o.setFieldValue("".concat(r,".from"),void 0),d.to&&o.setFieldValue("".concat(r,".to"),void 0))}),[d.type]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.mg,{fieldName:"".concat(r,".type"),label:"Time frame type",items:t,disabled:n,formik:o}),d.type===c.dw.FCFS?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.ln,{fieldName:"".concat(r,".from"),label:"From",disablePast:!0,formik:o}),(0,l.jsx)(s.ln,{fieldName:"".concat(r,".to"),label:"To",disablePast:!0,formik:o})]}):(0,l.jsx)(s.ln,{fieldName:"".concat(r,".at"),label:"At",disablePast:!0,formik:o})]})}var u=t(344);function f(e){var r=e.fieldName,t=e.disabled,i=e.formik;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.nv,{fieldName:"".concat(r,".pieces"),label:"Picies",number:!0,disabled:t,formik:i}),(0,l.jsx)(s.mg,{fieldName:"".concat(r,".unitOfWeight"),label:"Unit Of Weight",items:c.tt,disabled:t,formik:i}),(0,l.jsx)(s.nv,{fieldName:"".concat(r,".weight"),label:"Weight",number:!0,disabled:t,formik:i}),(0,l.jsx)(s.mg,{fieldName:"".concat(r,".unitOfLength"),label:"Unit Of Length",items:c.oh,disabled:t,formik:i}),(0,l.jsx)(s.nv,{fieldName:"".concat(r,".length"),label:"Length",number:!0,disabled:t,formik:i})]})}function m(e){var r=e.fieldName,t=e.disabled,i=e.formik,n=a()(i.values,r);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Um,{fieldName:"".concat(r,".facility"),label:"Facility",getSelectedLabel:function(e){return"".concat(e.name)},getItemLabel:function(e){return"".concat(e.name)},getItemSecondLabel:function(e){return"".concat(e.address)},ListIcon:o.Z,queryFn:u.ui,startEmpty:!1,orderby:"name",order:"asc",disabled:t,formik:i}),(0,l.jsx)(d,{fieldName:"".concat(r,".timeFrame"),values:[c.dw.FCFS,c.dw.APPT,c.dw.ASAP],disabled:t,formik:i}),n.freightList.map((function(e,n){return(0,l.jsx)(f,{fieldName:"".concat(r,".freightList[").concat(n,"]"),disabled:t,formik:i},n)})),(0,l.jsx)(s.nv,{fieldName:"".concat(r,".addInfo"),label:"Additional stop info",disabled:t,formik:i})]})}function p(e){var r=e.fieldName,t=e.disabled,i=e.formik;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Um,{fieldName:"".concat(r,".facility"),label:"Facility",getSelectedLabel:function(e){return"".concat(e.name)},getItemLabel:function(e){return"".concat(e.name)},getItemSecondLabel:function(e){return"".concat(e.address)},ListIcon:o.Z,queryFn:u.ui,startEmpty:!1,orderby:"name",order:"asc",disabled:t,formik:i}),(0,l.jsx)(d,{fieldName:"".concat(r,".timeFrame"),values:[c.dw.FCFS,c.dw.APPT,c.dw.Direct],disabled:t,formik:i}),(0,l.jsx)(s.nv,{fieldName:"".concat(r,".addInfo"),label:"Additional stop info",disabled:t,formik:i})]})}function b(e){var r=e.fieldName,t=e.disabled,i=e.formik,n=a()(i.values,r);return(0,l.jsx)(l.Fragment,{children:n?n.map((function(e,n){switch(e.type){case c.xn.PickUp:return(0,l.jsx)(m,{fieldName:"".concat(r,"[").concat(n,"]"),disabled:t,formik:i},n);case c.xn.Delivery:return(0,l.jsx)(p,{fieldName:"".concat(r,"[").concat(n,"]"),disabled:t,formik:i},n)}})):null})}},2835:function(e,r,t){t.d(r,{Ep:function(){return d},Gm:function(){return o},Hz:function(){return c},I2:function(){return a},KN:function(){return s},V3:function(){return i},dw:function(){return b},fg:function(){return l},oh:function(){return m},q6:function(){return u},tt:function(){return f},vX:function(){return n},xn:function(){return p}});var i=["EN","UA","ES","RU"],n=["Admin","Super Admin"],a=["BROKER DOMESTIC","BROKER INTERNATIONAL","FREIGHT FORWARDER DOMESTIC","FREIGHT FORWARDER INTERNATIONAL","SHIPPER/CONSIGNEE DOMESTIC","SHIPPER/CONSIGNEE INTERNATIONAL","OTHER"],o=["Cargo van","Reefer van","Box truck","Box truck Reefer","Straight truck","Hotshot","Tented box"],s=["Available","Not Available","Will be available","On route"],c=["Yes","No"],l=["Hazmat","Tsa","TWIC","Tanker Endorsement"],d=["Dock height risers","Air ride","Lift gate","Keep from freezing","ICC bar","Vertical E-track","Horizontal E-track","Pallet jack","PPE","Ramps","Straps","Loads bars","Blankets","Pads","Fire extinguisher","Metal hooks","Reefer","Heater"],u=["Available","Planned","In Progress","TONU","Cancelled","Completed"],f=["LBS","KG","TON"],m=["FT","IN","M","CM"],p=function(e){return e.PickUp="PickUp",e.Delivery="Delivery",e}({}),b=function(e){return e.FCFS="FCFS",e.APPT="APPT",e.ASAP="ASAP",e.Direct="Direct",e}({})},501:function(e,r,t){var i=t(4836);r.Z=void 0;var n=i(t(5649)),a=t(184),o=(0,n.default)((0,a.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");r.Z=o}}]);
//# sourceMappingURL=568.45f12fb2.chunk.js.map