"use strict";(self.webpackChunkadmin_frontend=self.webpackChunkadmin_frontend||[]).push([[491],{9491:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var i=n(1413),a=n(3433),r=n(9439),o=n(2791),c=n(7689),s=n(6403),l=n(3418),d=n(2917),u=n(6934),h=n(2065),f=n(5699),x=n(8550),m=n(68),p=n(3994),g=n(3786),v=n(4554),b=n(9836),j=n(3382),Z=n(9281),y=n(6890),k=n(3033),C=n(5855),w=n(720),S=n(4663),P=n(890),D=n(5527),F=n(1889),N=n(6151),O=n(3400),I=n(1588),T=n(1903),L=n(1528),q=n(5573),E=n(3199),R=n(1605),z=n(344),W=n(4682),A=n(5916),H=n(184),B=[{id:"truckNumber",orderField:"truckNumber",getData:function(e){return{data:"".concat(e.truckNumber)}},numeric:!0,disablePadding:!1,label:"Truck\xa0Number"},{id:"mainContactInfo",getData:function(e){var t=e.coordinator||e.owner,n="",i="",a="",r="";return t&&(n="./".concat((0,A.DW)(t),"/view/").concat(t.id),i="".concat((0,A.oL)(t)," "),a="".concat(t.fullName),r="".concat(null===t||void 0===t?void 0:t.phone)),{data:(0,H.jsxs)("span",{children:[(0,H.jsx)("b",{children:i}),(0,H.jsx)("a",{href:n,target:"_blank",onClick:Q,children:a}),(0,H.jsx)("br",{}),(0,H.jsx)("a",{href:r?"tel:".concat(r):void 0,target:"_blank",onClick:Q,children:r||"\xa0"})]}),title:i+""+a+"\n"+r}},numeric:!1,disablePadding:!0,label:"Main\xa0Contact\xa0info"},{id:"truckInfo",getData:function(e){var t=e.type?"".concat(e.type):"",n=e.equipment?"".concat(e.equipment.join(", ")):"";return{data:(0,H.jsxs)("span",{children:[t,(0,H.jsx)("br",{}),n]}),title:t+"\n"+n}},numeric:!1,disablePadding:!0,label:"Truck\xa0info"},{id:"dimsPayload",getData:function(e){var t=e.doorDims?"".concat(e.doorDims):"",n=e.payload?"".concat(e.payload):"";return{data:(0,H.jsxs)("span",{children:[t,(0,H.jsx)("br",{}),n]}),title:t+"\n"+n}},numeric:!1,disablePadding:!0,label:"DIMS/Payload"},{id:"status",orderField:"status",getData:function(e){return{data:"".concat(e.status)}},numeric:!1,disablePadding:!0,label:"Status"},{id:"roadsDistance",getData:function(e){return{data:"".concat(e.milesByRoads?e.milesByRoads.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Road\xa0distance"},{id:"location",getData:function(e){if(null!==e&&void 0!==e&&e.lastCity){var t="./locations/view/".concat(e.lastCity.id),n="".concat(e.lastCity.name,", ").concat(e.lastCity.stateCode,", ").concat(e.lastCity.zipCode,","),i="".concat(e.locationUpdatedAt?new Date(e.locationUpdatedAt).toLocaleString():"");return{data:(0,H.jsxs)("span",{children:[(0,H.jsx)("a",{href:t,target:"_blank",onClick:Q,children:n}),(0,H.jsx)("br",{}),i]}),title:n+"\n"+i}}return{data:""}},numeric:!1,disablePadding:!0,label:"Last\xa0known\xa0location"},{id:"calcDistance",getData:function(e){return{data:"".concat(e.milesHaversine?e.milesHaversine.toFixed(2):"")}},numeric:!1,disablePadding:!0,label:"Origin\xa0away"}],M=(0,u.ZP)(y.Z)((function(e){return{backgroundColor:e.theme.palette.background.default}})),_=(0,u.ZP)(p.Z)((function(e){e.theme;return{maxWidth:"100px",paddingTop:"6px",paddingBottom:"6px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}));function Q(e){e.stopPropagation()}function J(e){e.onSelectAllClick;var t=e.order,n=e.orderBy,i=(e.numSelected,e.rowCount,e.onRequestSort);return(0,H.jsx)(M,{children:(0,H.jsxs)(C.Z,{children:[(0,H.jsx)(_,{align:"center",padding:"checkbox",children:"Actions"}),B.map((function(e){return(0,H.jsx)(_,{align:e.numeric?"right":"center",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t,children:(0,H.jsxs)(w.Z,{active:e.orderField&&n===e.orderField,hideSortIcon:!e.orderField,direction:n===e.orderField?t:"asc",onClick:e.orderField?(a=e.orderField,function(e){i(e,a)}):function(){},children:[e.label,e.orderField&&n===e.orderField?(0,H.jsx)(v.Z,{component:"span",sx:q.Z,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id);var a}))]})})}function K(e){var t=e.selected,n=e.setQueryParams,u=o.useState(null),p=(0,r.Z)(u,2),b=p[0],j=p[1],Z=o.useState(""),y=(0,r.Z)(Z,2),k=y[0],C=y[1],w=o.useState({}),D=(0,r.Z)(w,2),N=D[0],q=D[1],B=o.useState([]),M=(0,r.Z)(B,2),_=M[0],Q=M[1],J=o.useState(200),K=(0,r.Z)(J,2),U=K[0],G=K[1],V=o.useState(!1),X=(0,r.Z)(V,2),Y=X[0],$=X[1],ee=((0,c.TH)(),(0,c.s0)(),(0,s.NL)()),te=(0,W.Ds)(),ne=(0,l.D)(z.RS,{onSuccess:function(){te({severity:"success",message:"Deleted"}),ee.invalidateQueries(["trucks"])},onError:function(e){te({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),ie=(ne.mutate,ne.isLoading),ae=o.useMemo((function(){return(0,E.Z)((function(e){q({search:e})}),400)}),[]),re=(0,d.a)({queryKey:["locations",0,15,"name","asc",N],queryFn:(0,A.vc)(z.He,!0),keepPreviousData:!0}).data,oe=(void 0===re?{items:[],total:0}:re).items;o.useEffect((function(){Q(b?[b]:""===k?[]:(0,a.Z)(oe))}),[b,oe]);var ce=function(){null!==b&&void 0!==b&&b.location&&(n({lastLocation:b.location.join(","),distance:U}),$(!1))};return(0,H.jsxs)(S.Z,{sx:(0,i.Z)({pl:{sm:2},pr:{xs:1,sm:1}},t.length>0&&{bgcolor:function(e){return(0,h.Fq)(e.palette.primary.main,e.palette.action.activatedOpacity)}}),children:[t.length>0?(0,H.jsxs)(P.Z,{sx:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1",component:"div",children:[t.length," selected"]}):(0,H.jsx)(P.Z,{sx:{flex:"1 1 100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},variant:"h6",id:"tableTitle",component:"div",children:"Trucks Nearby"}),(0,H.jsx)(v.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"350px"}},children:(0,H.jsx)(f.Z,{getOptionLabel:function(e){return"string"===typeof e?e:"".concat(e.name,", ").concat(e.zipCode,", ").concat(e.stateName)},filterOptions:function(e){return e},options:_,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!0,value:b,noOptionsText:"No locations",onChange:function(e,t){j(t),ce(),null!==t&&void 0!==t&&t.location?(n({lastLocation:t.location.join(","),distance:U}),$(!1)):t||(C(""),n({}),$(!1))},onInputChange:function(e,t){C(t),ae(t)},renderInput:function(e){return(0,H.jsx)(x.Z,(0,i.Z)((0,i.Z)({},e),{},{label:"Enter city, state or zip",size:"small",fullWidth:!0}))},renderOption:function(e,t){return(0,H.jsx)("li",(0,i.Z)((0,i.Z)({},e),{},{children:(0,H.jsxs)(F.ZP,{container:!0,alignItems:"center",children:[(0,H.jsx)(F.ZP,{item:!0,sx:{display:"flex",width:44},children:(0,H.jsx)(I.Z,{sx:{color:"text.secondary"}})}),(0,H.jsxs)(F.ZP,{item:!0,sx:{width:"calc(100% - 44px)",wordWrap:"break-word"},children:[(0,H.jsx)(v.Z,{component:"span",sx:{fontWeight:"regular"},children:"".concat(t.name,", ").concat(t.stateCode)}),(0,H.jsx)(P.Z,{variant:"body2",color:"text.secondary",children:"".concat(t.zipCode,", ").concat(t.stateName)})]})]})}))}})}),(0,H.jsx)(v.Z,{component:"div",sx:{"& .MuiTextField-root":{m:1,width:"140px"}},children:(0,H.jsx)(x.Z,{select:!0,label:"Select Distance",value:U,onChange:function(e){Number.isInteger(Number(e.target.value))&&(G(Number(e.target.value)),$(!0))},size:"small",fullWidth:!0,children:Array.from({length:20},(function(e,t){return 50+50*t})).map((function(e){return(0,H.jsx)(g.Z,{value:e,children:e},e)}))})}),(0,H.jsx)(m.Z,{title:"Filter list",children:!Y&&b||Y&&!b?(0,H.jsx)("span",{children:(0,H.jsx)(O.Z,{onClick:function(){j(null),C(""),G(200),n({}),$(!1)},children:(0,H.jsx)(L.Z,{})})}):(0,H.jsx)("span",{children:(0,H.jsx)(O.Z,{disabled:!b||!U,onClick:ce,children:(0,H.jsx)(T.Z,{})})})}),(0,H.jsx)(R.Z,{visible:ie})]})}function U(){var e=o.useState(void 0),t=(0,r.Z)(e,2),n=t[0],i=t[1],a=o.useState(void 0),s=(0,r.Z)(a,2),l=s[0],u=s[1],h=o.useState([]),f=(0,r.Z)(h,2),x=f[0],m=f[1],p=o.useState(0),g=(0,r.Z)(p,2),y=g[0],w=g[1],S=o.useState(15),P=(0,r.Z)(S,2),F=P[0],O=P[1],I=o.useState({}),T=(0,r.Z)(I,2),L=T[0],q=T[1],E=o.useRef(null),A=(0,c.TH)(),M=(0,c.s0)(),Q=(0,W.Ds)(),U=(0,d.a)({queryKey:["trucks",y,F,l,n,L],queryFn:z.g7,keepPreviousData:!0,onError:function(e){Q({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),G=U.isLoading,V=U.isFetching,X=U.data,Y=void 0===X?{items:[],total:0}:X,$=Y.items,ee=Y.total,te=$||[];o.useEffect((function(){E.current&&E.current.scrollTo({top:0,left:0,behavior:"smooth"})}),[te]),o.useEffect((function(){var e=[];x.forEach((function(t){te.find((function(e){return e.id===t}))&&e.push(t)})),m(e)}),[te]);return(0,H.jsxs)(v.Z,{sx:{width:"100%",height:"100%"},children:[(0,H.jsxs)(D.Z,{sx:{width:"100%",height:"100%",backgroundColor:"unset"},children:[(0,H.jsx)(K,{selected:x,setQueryParams:function(e){q(e),w(0)}}),(0,H.jsx)(Z.Z,{ref:E,sx:{height:"calc(100% - 115px)"},children:(0,H.jsxs)(b.Z,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",stickyHeader:!0,children:[(0,H.jsx)(J,{numSelected:x.length,order:n,orderBy:l,onSelectAllClick:function(e){if(e.target.checked){var t=te.map((function(e){return e.id}));m(t)}else m([])},onRequestSort:function(e,t){var a=l===t&&"asc"===n;l===t&&"desc"===n?(i(void 0),u(void 0)):(i(a?"desc":"asc"),u(t))},rowCount:te.length}),(0,H.jsx)(j.Z,{children:te.map((function(e,t){var n,i=(n="".concat(e.id),-1!==x.indexOf(n)),a="enhanced-table-checkbox-".concat(t);return(0,H.jsxs)(C.Z,{hover:!0,onClick:function(t){M("./view/".concat(e.id),{relative:"path",state:{from:A},replace:!1})},role:"checkbox","aria-checked":i,tabIndex:-1,selected:i,sx:{cursor:"pointer"},children:[(0,H.jsx)(_,{padding:"checkbox",children:(0,H.jsx)(N.Z,{id:"".concat(a),sx:{m:1},fullWidth:!0,variant:"contained",size:"small",color:"primary",onClick:function(){},children:"Reserve"})}),B.map((function(t){var n=t.getData(e);return(0,H.jsx)(_,{title:n.title,align:t.numeric?"right":"center",children:n.data},t.id)}))]},e.id)}))})]})}),(0,H.jsx)(k.Z,{rowsPerPageOptions:[5,10,15,20,25,35,50],component:"div",count:ee,rowsPerPage:F,page:y,onPageChange:function(e,t){w(t)},onRowsPerPageChange:function(e){O(parseInt(e.target.value,10)),w(0)}})]}),(0,H.jsx)(R.Z,{visible:G||V})]})}}}]);
//# sourceMappingURL=491.c9b024f9.chunk.js.map