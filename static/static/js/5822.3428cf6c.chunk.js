"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[5822],{5822:(n,o,e)=>{e.r(o),e.d(o,{default:()=>b});var t=e(5043),l=e(5604),i=e(5563),r=e(237),d=e(4836),s=e(3462),a=e(9347),c=e(5316),u=e(1906),v=e(8533),h=e(6600),p=e(6446),f=e(7392),m=e(4914),x=e(8612),w=e(1079),j=e(9056),g=e(6431),A=e(7166),k=e(5552),C=e(4133),E=e(9129),S=e(579);const L=t.forwardRef((function(n,o){return(0,S.jsx)(d.A,{direction:"up",ref:o,...n})}));function b(n){var o;let{truckListData:e}=n,r=k.gX,d=k.s_;1===e.length&&e[0].lastLocation&&(r={lat:e[0].lastLocation[0],lng:e[0].lastLocation[1]},d*=2);const[b,I]=t.useState(null),[_,M]=t.useState(""),[O,R]=t.useState(null),[U,z]=t.useState(!1),{refetch:F}=(0,l.I)({queryKey:["truckForMap",_],queryFn:w.k$,keepPreviousData:!1,retry:!1,enabled:!1});t.useEffect((()=>{if(_){z(!0);const n=null===e||void 0===e?void 0:e.find((n=>n.id===_)),o=n&&(null===n||void 0===n?void 0:n.lastLocation);Promise.all([F().then((n=>n.data)),o&&((null===b||void 0===b?void 0:b.geocode({location:{lat:o[0],lng:o[1]}}))||Promise.reject()).then((n=>{const o=(0,C.U)(n.results);return o?(0,E.s)(o.address_components):""}))]).then((n=>{let[o,e]=n;R(o?{...o,lastCity:e||""}:null)})).catch((()=>R(null))).finally((()=>z(!1)))}else R(null)}),[_]);const P=()=>{M("")};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(p.A,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,S.jsx)(i.Wrapper,{...(0,k.iz)(),render:n=>{const o=(0,j.dh)(),[,e]=(0,j.pn)();return t.useLayoutEffect((()=>(n===i.Status.LOADING&&e(!0),n===i.Status.FAILURE&&o({severity:"error",message:"Error loading maps!"}),n===i.Status.SUCCESS&&I(new window.google.maps.Geocoder),()=>{n===i.Status.LOADING&&e(!1)})),[n]),null}}),b?(0,S.jsx)(y,{center:r,zoom:d,mapId:k.yw,children:(0,S.jsx)(N,{children:e.map((n=>(0,S.jsx)(T,{onCLick:()=>{return o=n.id,void M(o);var o},title:"".concat(n.truckNumber,"\n").concat(n.status),position:{lat:n.lastLocation[0],lng:n.lastLocation[1]}},n.id)))})}):null]}),(0,S.jsxs)(s.A,{open:!!O,TransitionComponent:L,keepMounted:!0,onClose:P,"aria-describedby":"alert-dialog-slide-description",children:[(0,S.jsx)(h.A,{children:(0,S.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,S.jsx)("a",{href:"./trucks/view/".concat(null===O||void 0===O?void 0:O.id),target:"_blank",children:null===O||void 0===O?void 0:O.truckNumber})]})}),(0,S.jsxs)(c.A,{children:[(0,S.jsx)(v.A,{id:"truck-status",children:"CURRENT STATUS: ".concat(null===O||void 0===O?void 0:O.status)}),(0,S.jsx)(v.A,{id:"main-contact",children:(0,S.jsxs)("span",{children:["MAIN CONTACT: ",(0,S.jsx)("b",{children:"".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?(0,g.Pw)((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)):"")})," ".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).fullName:""),(0,S.jsx)(f.A,{size:"small",onClick:n=>{var o;(0,A.d)(n),navigator.clipboard.writeText(" ".concat(null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).fullName:""," ").concat((null===(o=(null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner))||void 0===o?void 0:o.phone)||""))},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})}),(0,S.jsx)(v.A,{id:"main-contact-number",children:(0,S.jsxs)("span",{children:["MAIN CONTACT #: ",(0,S.jsx)("a",{href:null!==O&&void 0!==O&&O.coordinator||null!==O&&void 0!==O&&O.owner?"tel:".concat(((null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner)).phone):void 0,target:"_blank",onClick:A.d,children:(null===(o=(null===O||void 0===O?void 0:O.coordinator)||(null===O||void 0===O?void 0:O.owner))||void 0===o?void 0:o.phone)||""})]})}),(0,S.jsx)(v.A,{id:"last-location",children:(0,S.jsxs)("span",{children:["LAST LOCATION #: ".concat(null===O||void 0===O?void 0:O.lastCity),(0,S.jsx)(f.A,{size:"small",onClick:n=>{(0,A.d)(n),navigator.clipboard.writeText("".concat(null===O||void 0===O?void 0:O.lastCity))},children:(0,S.jsx)(m.A,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,S.jsx)(a.A,{children:(0,S.jsx)(u.A,{onClick:P,children:"Close"})})]}),(0,S.jsx)(x.A,{visible:U})]})}function y(n){let{center:o,zoom:e,mapId:l,children:i}=n;const r=t.useRef(null),[d,s]=t.useState();t.useEffect((()=>{r.current&&!d&&s(new window.google.maps.Map(r.current,{center:o,zoom:e,mapId:l}))}),[r,d]);const a=t.Children.only(i);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{height:"100%",width:"100%"},ref:r,id:"map"}),t.isValidElement(a)&&t.cloneElement(a,{map:d})]})}function N(n){let{map:o,children:e}=n;console.log(o);const[l,i]=t.useState();return t.useEffect((()=>{if(!l&&o){const n=new r.w1({});n.setMap(o),i(n)}}),[o,l]),t.useEffect((()=>{l&&l.render()}),[o,e,l]),null===l||void 0===l||l.render(),(0,S.jsx)(S.Fragment,{children:t.Children.map(e,(n=>{if(t.isValidElement(n))return t.cloneElement(n,{map:o,clusterer:l})}))})}const T=n=>{const{onCLick:o,clusterer:e,map:l,position:i,...r}=n,[d,s]=t.useState();return t.useEffect((()=>{if(!d){const n=new window.google.maps.marker.AdvancedMarkerElement;s(n),n.addListener("click",o)}}),[d]),t.useEffect((()=>{d&&(d.map=l||null)}),[d,l]),t.useEffect((()=>{d&&(d.position=i)}),[d,i&&"".concat(null===i||void 0===i?void 0:i.lat,",").concat(null===i||void 0===i?void 0:i.lng)]),t.useEffect((()=>{d&&(null===e||void 0===e||e.addMarker(d,!1))}),[d,e]),t.useEffect((()=>{d&&Object.assign(d,r)}),[d,r]),null}},7166:(n,o,e)=>{function t(n){n.stopPropagation()}e.d(o,{d:()=>t})}}]);
//# sourceMappingURL=5822.3428cf6c.chunk.js.map