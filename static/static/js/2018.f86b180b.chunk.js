"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[2018],{9637:(e,r,i)=>{i.r(r),i.d(r,{default:()=>C});var t=i(5043),o=i(9781),s=i(5604),d=i(2836),a=i(3892),n=i(899),l=i(6446),u=i(1906),c=i(9336),m=i(2991),f=i(9404),p=i(2177),y=i(474),h=i(695),q=i(1079),b=i(908),g=i(8833),k=i(6431),j=i(579);const x=n.Ik({type:n.Yj().oneOf([g.P7.FCFS,g.P7.ASAP,g.P7.APPT]).required("Type is required"),at:n.p6().when(["type"],((e,r)=>e[0]===g.P7.FCFS?r.oneOf([void 0]):r.required("At is required"))),from:n.p6().when(["type"],((e,r)=>e[0]!==g.P7.FCFS?r.oneOf([void 0]):r.required("From is required"))),to:n.p6().when(["type"],((e,r)=>e[0]!==g.P7.FCFS?r.oneOf([void 0]):r.required("To is required")))}),A=n.Ik({type:n.Yj().oneOf([g.P7.FCFS,g.P7.Direct,g.P7.APPT]).required("Type is required"),at:n.p6().when(["type"],((e,r)=>e[0]===g.P7.FCFS?r.oneOf([void 0]):r.required("At is required"))),from:n.p6().when(["type"],((e,r)=>e[0]!==g.P7.FCFS?r.oneOf([void 0]):r.required("From is required"))),to:n.p6().when(["type"],((e,r)=>e[0]!==g.P7.FCFS?r.oneOf([void 0]):r.required("To is required")))}),T=n.Ik({pieces:n.ai().integer().min(1).required("Pieces must be at least 1"),unitOfWeight:n.Yj().oneOf(g.Lv).required("Unit of weight is required"),weight:n.ai().moreThan(0).required("Weight is required"),unitOfLength:n.Yj().oneOf(g.Ny).required("Unit of length is required"),length:n.ai().moreThan(0).required("Length is required")}),v=n.Ik({facility:n.Ik({id:n.Yj().required()}).typeError("Enter correct facility").required("Facility is required"),timeFrame:x.required("Time frame is required"),freightList:n.YO().of(T.required("Freight is required")).required("Stop pickup must contain al least one freight"),addInfo:n.Yj()}),F=n.Ik({facility:n.Ik({id:n.Yj().required()}).typeError("Enter correct facility").required("Facility is required"),timeFrame:A.required("Time frame is required"),addInfo:n.Yj()}),S=n.Ik({status:n.Yj().oneOf(g.Jf).required("Status is required"),ref:n.YO().of(n.Yj().required("Ref must not be empty")).min(1,"REF is required").max(3,"REF must contain not more then 3 items").required("REF is required"),stops:n.YO().of(n.RZ((e=>{switch(e.type){case g.lk.PickUp:return v.required("Stop pickup is required");case g.lk.Delivery:return F.required("Stop delivery is required");default:return n.gl().oneOf([void 0]).required('Type of stop must be "Pick Up" or "Delivery"')}}))).min(2).required("Stops are required"),weight:n.Yj().required("Weight is required"),truckType:n.YO(n.Yj().oneOf(g.Ju)).min(1,"Select at list one").required("Truck Type is required"),rate:n.ai().typeError("Rate must be a number"),totalCharges:n.ai().typeError("Total charges must be a number").required("Total charges is required"),currency:n.Yj().required("Currency is required"),bookedByUser:n.Ik({id:n.Yj().required()}).required("Booked by is required"),bookedByCompany:n.Yj(),assignTo:n.YO(n.Ik({id:n.Yj().required()}).typeError("Enter correct user")).min(1,"Assign To is required").required("Assign To is required"),checkInAs:n.Yj(),truck:n.Ik({id:n.Yj().required()}).typeError("Enter correct truck").nullable(),bookedWith:n.Ik({id:n.Yj().required()}).typeError("Enter correct customer").required("Booked with is required")}),I={id:"",status:"Available",ref:[],stops:[],weight:void 0,truckType:[],rate:void 0,totalCharges:void 0,currency:"USD",bookedByUser:null,bookedByCompany:void 0,assignTo:[],checkInAs:"4ULogistics",truck:null,bookedWith:null};function C(e){let{id:r,onClose:i}=e;const[n,x]=t.useState(I),A=(0,o.jE)(),T=(0,b.dh)(),{isLoading:v,isFetching:F,data:C}=(0,s.I)({queryKey:["load",r],queryFn:q.bQ,retry:!1,onError:e=>{T({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),{mutate:w,isLoading:L}=(0,d.n)(q.QD,{onSuccess:e=>{T({severity:"success",message:"Saved"}),A.invalidateQueries(["load",r]),A.invalidateQueries(["loads"]),i("Save",e)},onError:e=>{T({severity:"error",message:e instanceof Error?e.message:JSON.stringify(e)})}}),Y=(0,a.Wx)({initialValues:n,enableReinitialize:!0,validationSchema:S,onSubmit:e=>{w(e)}});t.useEffect((()=>{x({...n,...(0,k.jv)(C,Object.keys(n))})}),[C]);return(0,j.jsxs)(l.A,{sx:{height:"100%"},children:[(0,j.jsx)("form",{onSubmit:Y.handleSubmit,onReset:Y.handleReset,style:{height:"100%"},children:(0,j.jsxs)(l.A,{sx:{p:3,height:"100%"},children:[(0,j.jsx)(c.A,{}),(0,j.jsxs)(l.A,{sx:{maxHeight:"calc(100% - 70px)",overflowX:"hidden",overflowY:"scroll"},children:[(0,j.jsxs)(l.A,{sx:{marginBottom:-1,p:1},children:[(0,j.jsx)(h.zM,{fieldName:"status",label:"Status",items:g.Jf,formik:Y}),(0,j.jsx)(h.A_,{fieldName:"ref",label:"REF",multiline:!0,maxRows:3,formik:Y}),(0,j.jsx)(y.A,{fieldName:"stops",formik:Y})]},"topControls"),(0,j.jsxs)(l.A,{sx:{display:"inline-flex",width:"100%"},children:[(0,j.jsxs)(l.A,{sx:{p:1,width:"50%"},children:[(0,j.jsx)(h.A_,{fieldName:"weight",label:"Weight",formik:Y}),(0,j.jsx)(h.yJ,{fieldName:"truckType",label:"Truck Type",items:g.Ju,formik:Y}),(0,j.jsx)(h.Lw,{fieldName:"bookedByUser",label:"Booked By",getSelectedLabel:e=>"".concat(e.fullName),getItemLabel:e=>"".concat(e.fullName),getItemSecondLabel:e=>"".concat(e.jobTitle),ListIcon:p.A,entityType:"User",queryFn:q.Fw,orderby:"fullName",order:"asc",formik:Y}),(0,j.jsx)(h.Lw,{fieldName:"bookedWith",label:"Booked With",getSelectedLabel:e=>"".concat(e.name),getItemLabel:e=>"".concat(e.name),getItemSecondLabel:e=>"".concat(e.type),ListIcon:f.A,entityType:"Customer",queryFn:q.sg,orderby:"name",order:"asc",formik:Y}),(0,j.jsx)(h.Lw,{fieldName:"truck",label:"Truck",getSelectedLabel:e=>"".concat(e.truckNumber),getItemLabel:e=>"".concat(e.truckNumber),getItemSecondLabel:e=>"".concat(e.status,", ").concat(e.licencePlate),ListIcon:m.A,entityType:"Truck",queryFn:q.fG,orderby:"truckNumber",order:"asc",formik:Y})]},"left"),(0,j.jsxs)(l.A,{sx:{p:1,width:"50%"},children:[(0,j.jsx)(h.A_,{fieldName:"rate",label:"Rate",number:!0,formik:Y}),(0,j.jsx)(h.A_,{fieldName:"totalCharges",label:"Total Charges",placeholder:"Enter total rate",number:!0,formik:Y}),(0,j.jsx)(h.A_,{fieldName:"currency",label:"Currency",formik:Y}),(0,j.jsx)(h.A_,{fieldName:"checkInAs",label:"Check In As",formik:Y}),(0,j.jsx)(h.A_,{fieldName:"bookedByCompany",label:"Booked By Company",formik:Y})]},"right")]},"centerControls"),(0,j.jsxs)(l.A,{sx:{p:1,paddingBottom:0,paddingTop:0},children:[(0,j.jsx)(h.YY,{fieldName:"assignTo",label:"Assign To",getSelectedLabel:e=>"".concat(e.fullName),getItemLabel:e=>"".concat(e.fullName),getItemSecondLabel:e=>"".concat(e.jobTitle),ListIcon:p.A,queryFn:q.Fw,orderby:"fullName",order:"asc",formik:Y}),(0,j.jsx)(l.A,{sx:{paddingBottom:2,paddingTop:2}},"spacerRate"),(0,j.jsx)(h.$c,{objectId:null===C||void 0===C?void 0:C.id,objectType:"Load",label:"Rate Files",tags:{["".concat(null===C||void 0===C?void 0:C.id)]:"Rate"}}),(0,j.jsx)(l.A,{sx:{paddingBottom:2,paddingTop:2}},"spacerBill"),(0,j.jsx)(h.$c,{objectId:null===C||void 0===C?void 0:C.id,objectType:"Load",label:"Bill Files",tags:{["".concat(null===C||void 0===C?void 0:C.id)]:"Bill"}})]},"bottomControls")]},"controls"),(0,j.jsx)(c.A,{}),(0,j.jsxs)(l.A,{sx:{paddingTop:3,display:"flex"},children:[(0,j.jsx)(l.A,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,j.jsx)(u.A,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"submit",disabled:!Y.dirty,children:"Save"})},"left"),(0,j.jsx)(l.A,{sx:{p:1,paddingTop:0,width:"50%"},children:(0,j.jsx)(u.A,{fullWidth:!0,variant:"contained",size:"small",color:"primary",type:"button",onClick:()=>{i("Close")},children:"Cancel"})},"right")]},"buttons")]})}),(0,j.jsx)(h.aH,{visible:L||v||F})]})}}}]);
//# sourceMappingURL=2018.f86b180b.chunk.js.map